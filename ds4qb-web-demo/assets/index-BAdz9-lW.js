var pn=Object.defineProperty;var Ot=a=>{throw TypeError(a)};var hn=(a,n,t)=>n in a?pn(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t;var ke=(a,n,t)=>hn(a,typeof n!="symbol"?n+"":n,t),dt=(a,n,t)=>n.has(a)||Ot("Cannot "+t);var c=(a,n,t)=>(dt(a,n,"read from private field"),t?t.call(a):n.get(a)),w=(a,n,t)=>n.has(a)?Ot("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(a):n.set(a,t),v=(a,n,t,o)=>(dt(a,n,"write to private field"),o?o.call(a,t):n.set(a,t),t),D=(a,n,t)=>(dt(a,n,"access private method"),t);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function t(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(r){if(r.ep)return;r.ep=!0;const l=t(r);fetch(r.href,l)}})();const _n="modulepreload",mn=function(a){return"/"+a},Pt={},Mt=function(n,t,o){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));r=Promise.allSettled(t.map(p=>{if(p=mn(p),p in Pt)return;Pt[p]=!0;const h=p.endsWith(".css"),y=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${y}`))return;const e=document.createElement("link");if(e.rel=h?"stylesheet":_n,h||(e.as="script"),e.crossOrigin="",e.href=p,f&&e.setAttribute("nonce",f),document.head.appendChild(e),h)return new Promise((i,s)=>{e.addEventListener("load",i),e.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${p}`)))})}))}function l(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return r.then(u=>{for(const f of u||[])f.status==="rejected"&&l(f.reason);return n().catch(l)})};var ve,yt,fe,we,Te;(function(a){a[a.CTRL_SYNC=0]="CTRL_SYNC",a[a.GET_SECTOR_COUNT=1]="GET_SECTOR_COUNT",a[a.GET_SECTOR_SIZE=2]="GET_SECTOR_SIZE",a[a.GET_BLOCK_SIZE=3]="GET_BLOCK_SIZE",a[a.CTRL_TRIM=4]="CTRL_TRIM"})(ve||(ve={})),function(a){a[a.FAT=1]="FAT",a[a.FAT32=2]="FAT32",a[a.EXFAT=4]="EXFAT",a[a.ANY=7]="ANY",a[a.SFD=8]="SFD"}(yt||(yt={})),function(a){a[a.OK=0]="OK",a[a.DISK_ERR=1]="DISK_ERR",a[a.INT_ERR=2]="INT_ERR",a[a.NOT_READY=3]="NOT_READY",a[a.NO_FILE=4]="NO_FILE",a[a.NO_PATH=5]="NO_PATH",a[a.INVALID_NAME=6]="INVALID_NAME",a[a.DENIED=7]="DENIED",a[a.EXIST=8]="EXIST",a[a.INVALID_OBJECT=9]="INVALID_OBJECT",a[a.WRITE_PROTECTED=10]="WRITE_PROTECTED",a[a.INVALID_DRIVE=11]="INVALID_DRIVE",a[a.NOT_ENABLED=12]="NOT_ENABLED",a[a.NO_FILESYSTEM=13]="NO_FILESYSTEM",a[a.MKFS_ABORTED=14]="MKFS_ABORTED",a[a.TIMEOUT=15]="TIMEOUT",a[a.LOCKED=16]="LOCKED",a[a.NOT_ENOUGH_CORE=17]="NOT_ENOUGH_CORE",a[a.TOO_MANY_OPEN_FILES=18]="TOO_MANY_OPEN_FILES",a[a.INVALID_PARAMETER=19]="INVALID_PARAMETER"}(fe||(fe={})),function(a){a[a.RDO=1]="RDO",a[a.HID=2]="HID",a[a.SYS=4]="SYS",a[a.DIR=16]="DIR",a[a.ARC=32]="ARC"}(we||(we={})),function(a){a[a.READ=1]="READ",a[a.WRITE=2]="WRITE",a[a.OPEN_EXISTING=0]="OPEN_EXISTING",a[a.CREATE_NEW=4]="CREATE_NEW",a[a.CREATE_ALWAYS=8]="CREATE_ALWAYS",a[a.OPEN_ALWAYS=16]="OPEN_ALWAYS",a[a.OPEN_APPEND=48]="OPEN_APPEND"}(Te||(Te={}));const ye=24,gn=new URL(new URL("./ff_multi-DauRTzqn-DauRTzqn.wasm",import.meta.url).href,import.meta.url),yn=new URL(new URL("./ff_single-BRr2adYw-BRr2adYw.wasm",import.meta.url).href,import.meta.url);function P(a,n,t){const o=n();if(o!==fe.OK)throw t==null||t(),new vn(a,o)}var Oe,je,Vt;let Lt=(Vt=class{constructor(n,t){w(this,Oe);w(this,je);v(this,Oe,n),v(this,je,t)}get ptr(){return c(this,Oe)}get cSize(){return c(this,je).view.getUint16(c(this,Oe)+10,!0)}},Oe=new WeakMap,je=new WeakMap,Vt);var Pe,Me,Wt;let bn=(Wt=class{constructor(n,t){w(this,Pe);w(this,Me);v(this,Pe,n),v(this,Me,t)}get heap(){return new Uint8Array(c(this,Pe).buffer)}get view(){return new DataView(c(this,Pe).buffer)}allocString(n){if(n==null)return 0;const t=new TextEncoder().encode(n),o=this.alloc(t.length+1),r=this.heap.subarray(o,o+t.length+1);return r.set(t),r[r.length-1]=0,o}alloc(n){return c(this,Me).malloc(n)}free(n){c(this,Me).free(n)}decodeString(n,t){const o=this.heap.subarray(n,n+t),r=o.indexOf(0),l=r>=0?o.subarray(0,r):o;return new TextDecoder().decode(l)}enterScope(n){const t=[],o={alloc:r=>{const l=this.alloc(r);return t.unshift(l),l},allocString:r=>{const l=this.allocString(r);return t.unshift(l),l}};try{return n(o)}finally{for(const r of t)this.free(r)}}},Pe=new WeakMap,Me=new WeakMap,Wt),nt=class Qt{constructor(n,t,o,r){ke(this,"size");ke(this,"date");ke(this,"attrib");ke(this,"name");this.size=n,this.date=t,this.attrib=o,this.name=r}static fromFilInfo(n){const t=new DataView(n.buffer,n.byteOffset,n.byteLength),o=t.getUint32(0,!0),r=t.getUint16(4,!0),l=1980+((65024&r)>>9),u=((480&r)>>5)-1,f=31&r,p=t.getUint16(6,!0),h=new Date(l,u,f,(63488&p)>>11,(2016&p)>>5,2*(31&p)),y=n[8],e=n.subarray(9,22),i=e.indexOf(0),s=i>=0?e.subarray(0,i):e,d=new TextDecoder().decode(s);return new Qt(o,h,y,d)}get isReadOnly(){return!!(this.attrib&we.RDO)}get isDirectory(){return!!(this.attrib&we.DIR)}get isHidden(){return!!(this.attrib&we.HID)}get isArchive(){return!!(this.attrib&we.ARC)}get isSystem(){return!!(this.attrib&we.SYS)}},vn=class jt extends Error{constructor(t,o){super(`Error ${t}: ${fe[o]} (${o})`);ke(this,"result");Object.setPrototypeOf(this,jt.prototype),this.result=o}};var F,C,X;class wn{constructor(n,t,o){w(this,F);w(this,C);w(this,X);v(this,F,n),v(this,C,t),v(this,X,o)}get fp(){return c(this,F)}read(n,t){const o=c(this,C).f_read,r=c(this,F),l=t??n.length;return c(this,X).enterScope(u=>{const f=u.alloc(l),p=u.alloc(4);P("reading file",()=>o(r,f,l,p));const h=c(this,X).view.getUint32(p,!0);return n.set(c(this,X).heap.subarray(f,f+h)),h})}write(n,t){return c(this,X).enterScope(o=>{const r=t??n.length,l=o.alloc(r),u=o.alloc(4);return c(this,X).heap.subarray(l,l+r).set(n),P("writing file",()=>c(this,C).f_write(c(this,F),l,r,u)),c(this,X).view.getUint32(u,!0)})}close(){try{P("closing file",()=>c(this,C).f_close(c(this,F)))}finally{c(this,C).free(c(this,F))}}sync(){P("syncing disk",()=>c(this,C).f_sync(c(this,F)))}lseek(n){P("seeking",()=>c(this,C).f_lseek(c(this,F),n))}rewind(){this.lseek(0)}truncate(){P("truncating file",()=>c(this,C).f_truncate(c(this,F)))}expand(n,t){P("expanding file",()=>c(this,C).f_expand(c(this,F),n,t))}gets(n){return c(this,X).enterScope(t=>{const o=t.alloc(n+1);return P("reading string from file",()=>c(this,C).f_gets(o,n,c(this,F))),c(this,X).decodeString(o,n+1)})}putc(n){const t=n%256;return c(this,C).f_putc(t,c(this,F))}puts(n){const t=c(this,C).f_puts;return c(this,X).enterScope(o=>{const r=o.allocString(n);return t(r,c(this,F))})}tell(){return c(this,C).f_tell(c(this,F))}eof(n){return c(this,C).f_eof(c(this,F))}size(){return c(this,C).f_size(c(this,F))}error(n){return c(this,C).f_error(c(this,F))}}F=new WeakMap,C=new WeakMap,X=new WeakMap;var ee,he,ae,Xt;let It=(Xt=class{constructor(n,t,o){w(this,ee);w(this,he);w(this,ae);v(this,ee,n),v(this,he,t),v(this,ae,o)}get dp(){return c(this,ee)}close(){P("closing directory",()=>c(this,he).f_closedir(c(this,ee))),c(this,ae).free(c(this,ee))}read(){return c(this,ae).enterScope(n=>{const t=n.alloc(ye);P("reading directory",()=>c(this,he).f_readdir(c(this,ee),t));const o=c(this,ae).heap.subarray(t,t+ye);return nt.fromFilInfo(o)})}rewind(){P("rewinding directory",()=>c(this,he).f_readdir(c(this,ee),0))}findNext(){return c(this,ae).enterScope(n=>{const t=n.alloc(ye);P("searching directory for next match",()=>c(this,he).f_findnext(c(this,ee),t));const o=c(this,ae).heap.subarray(t,t+ye);return nt.fromFilInfo(o)})}*[Symbol.iterator](){let n;for(this.rewind();(n=this.read()).name!=="";)yield n}},ee=new WeakMap,he=new WeakMap,ae=new WeakMap,Xt);const Sn={multiPartition:!1,sectorSize:512};var T,L;const xt=class xt{constructor(n,t){w(this,T);w(this,L);v(this,T,n),v(this,L,t)}static async create(n,t){const o=new WebAssembly.Memory({initial:8}),r={...Sn,...t??{}},l=function(h,y,e){const i=0|(e??512),s=y.byteLength/i|0;return{env:{memory:h,disk_initialize:d=>fe.OK,disk_status:d=>fe.OK,disk_read:(d,m,g,_)=>{const b=y.subarray(g*i,(g+_)*i);return new Uint8Array(h.buffer).set(b,m),fe.OK},disk_write:(d,m,g,_)=>{const b=new Uint8Array(h.buffer).subarray(m,m+_*i);return y.set(b,g*i),fe.OK},disk_ioctl:(d,m,g)=>{const _=new DataView(h.buffer);switch(m){case ve.CTRL_SYNC:break;case ve.GET_SECTOR_SIZE:_.setUint16(g,i,!0);break;case ve.GET_SECTOR_COUNT:_.setUint32(g,s,!0);break;case ve.GET_BLOCK_SIZE:return 1;case ve.CTRL_TRIM:}return fe.OK},get_fattime:()=>{const d=new Date;return(d.getFullYear()-1980)%128<<25|d.getMonth()+1<<21|d.getDay()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>1}}}}(o,n,r.sectorSize),u=await async function(h,y){const e=y!=null&&y.multiPartition?gn:yn;if(typeof window<"u")return await WebAssembly.instantiateStreaming(fetch(e),h);{const{readFile:i}=await Mt(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),{fileURLToPath:s}=await Mt(async()=>{const{fileURLToPath:m}=await import("./__vite-browser-external-BIHI7g3E.js");return{fileURLToPath:m}},[]),d=await i(s(e));return await WebAssembly.instantiate(d,h)}}(l,r),f=u.instance.exports,p=new bn(o,f);return r.multiPartition?new An(p,f):new xt(p,f)}mkfs(n){c(this,T).enterScope(t=>{const o=t.allocString((n==null?void 0:n.path)??"");let r=0;if(n!=null){r=t.alloc(16);const u=c(this,T).view;u.setUint8(r,(n==null?void 0:n.fmt)??0),u.setUint8(r+1,(n==null?void 0:n.nFat)??0),u.setUint32(r+2,(n==null?void 0:n.align)??0,!0),u.setUint32(r+6,(n==null?void 0:n.nRoot)??0,!0),u.setUint32(r+10,(n==null?void 0:n.auSize)??0,!0)}const l=t.alloc(4096);P("formatting disk",()=>c(this,L).f_mkfs(o,r,l,4096))})}mount(n,t){const o=r=>c(this,T).alloc(r);return c(this,T).enterScope(r=>{const l=o(560);for(let f=0;f<560;f++)c(this,T).heap[l+f]=0;const u=r.allocString(n??"");return P("mounting workspace",()=>c(this,L).f_mount(l,u,t??0),()=>c(this,T).free(l)),new Lt(l,c(this,T))})}unmount(n){return c(this,T).enterScope(t=>{try{const o=t.allocString(n??"");P("unmounting workspace",()=>c(this,L).f_mount(0,o,0))}finally{}})}open(n,t){return c(this,T).enterScope(o=>{const r=o.allocString(n),l=c(this,T).alloc(576);return P("opening file",()=>c(this,L).f_open(l,r,t),()=>c(this,T).free(l)),new wn(l,c(this,L),c(this,T))})}session(n,t=""){this.mount(t);try{return n()}finally{this.unmount(t)}}readFile(n){const t=this.stat(n),o=new Uint8Array(t.size),r=this.open(n,Te.READ);try{return r.read(o),o}finally{r.close()}}writeFile(n,t){const o=this.open(n,Te.WRITE|Te.OPEN_ALWAYS);try{o.write(t)}finally{o.close()}}openDir(n){return c(this,T).enterScope(t=>{const o=t.allocString(n),r=c(this,T).alloc(64);return P("opening directory",()=>c(this,L).f_opendir(r,o),()=>c(this,T).free(r)),new It(r,c(this,L),c(this,T))})}findFirst(n,t){return c(this,T).enterScope(o=>{const r=o.allocString(n),l=o.allocString(t),u=o.alloc(ye),f=c(this,T).alloc(64);P("searching directory",()=>c(this,L).f_findfirst(f,u,r,l));const p=c(this,T).heap.subarray(u,u+ye);return[new It(f,c(this,L),c(this,T)),nt.fromFilInfo(p)]})}*find(n,t){let o,r;for([o,r]=this.findFirst(n,t);r.name!=="";)yield r,r=o.findNext()}stat(n){return c(this,T).enterScope(t=>{const o=t.allocString(n),r=t.alloc(ye);P("getting file information",()=>c(this,L).f_stat(o,r));const l=c(this,T).heap.subarray(r,r+ye);return nt.fromFilInfo(l)})}unlink(n){c(this,T).enterScope(t=>{const o=t.allocString(n);P("deleting file or directory",()=>c(this,L).f_unlink(o))})}rename(n,t){c(this,T).enterScope(o=>{const r=o.allocString(n),l=o.allocString(t);P("renaming file or directory",()=>c(this,L).f_rename(r,l))})}chmod(n,t,o){c(this,T).enterScope(r=>{const l=r.allocString(n);P("changing file or directory permissions",()=>c(this,L).f_chmod(l,t,o))})}utime(n,t){c(this,T).enterScope(o=>{const r=o.allocString(n),l=o.alloc(24),u=(t.getFullYear()-1980&127)<<9|t.getMonth()+1<<5|t.getDay();c(this,T).view.setUint16(l+4,u,!0);const f=t.getHours()<<11|t.getMinutes()<<5|t.getSeconds()>>>1;c(this,T).view.setUint16(l+6,f,!0),P("changing timestamp of file or directory",()=>c(this,L).f_utime(r,l))})}mkdir(n){c(this,L).f_mkdir,c(this,T).enterScope(t=>{const o=t.allocString(n);P("creating directory",()=>c(this,L).f_mkdir(o))})}chdir(n){c(this,T).enterScope(t=>{const o=t.allocString(n);P("changing current directory",()=>c(this,L).f_chdir(o))})}chdrive(n){c(this,T).enterScope(t=>{const o=t.allocString(n);P("changing current drive",()=>c(this,L).f_chdrive(o))})}getcwd(){return c(this,T).enterScope(n=>{const t=n.alloc(260);return P("getting current directory",()=>c(this,L).f_getcwd(t,260)),c(this,T).decodeString(t,260)})}getFree(n){return c(this,T).enterScope(t=>{const o=t.allocString(n??""),r=t.alloc(4),l=t.alloc(4);return P("getting free space on drive",()=>c(this,L).f_getfree(o,r,l)),[c(this,T).view.getUint32(r,!0),new Lt(l,c(this,T))]})}getLabel(n){return c(this,T).enterScope(t=>{const o=t.allocString(n??""),r=t.alloc(13);c(this,T).heap[r+12]=0;const l=t.alloc(4);return P("getting volume label",()=>c(this,L).f_getlabel(o,r,l)),[c(this,T).decodeString(r,13),c(this,T).view.getUint32(l,!0)]})}setLabel(n){c(this,T).enterScope(t=>{const o=t.allocString(n);P("setting volume label",()=>c(this,L).f_setlabel(o))})}setCP(n){const t=c(this,L).f_setcp;P("setting active code page",()=>t(n))}};T=new WeakMap,L=new WeakMap;let Ye=xt;var Le,Ze,Yt;let An=(Yt=class extends Ye{constructor(t,o){super(t,o);w(this,Le);w(this,Ze);v(this,Le,t),v(this,Ze,o)}fdisk(t,o){c(this,Le).enterScope(r=>{const l=r.alloc(512),u=r.alloc(4*t.length);for(let f=0;f<t.length;f++)c(this,Le).view.setUint32(u+4*f,t[f]);P("partitioning disk",()=>c(this,Ze).f_fdisk(o??0,u,l))})}},Le=new WeakMap,Ze=new WeakMap,Yt);function Zt(a){return a.arrayBuffer?a.arrayBuffer():new Promise((n,t)=>{const o=new FileReader;o.addEventListener("loadend",()=>{n(o.result)}),o.addEventListener("error",t),o.readAsArrayBuffer(a)})}async function Tn(a){const n=await Zt(a);return new Uint8Array(n)}function Kt(a){return typeof Blob<"u"&&a instanceof Blob}function Qe(a){return typeof SharedArrayBuffer<"u"&&a instanceof SharedArrayBuffer}const En=typeof process<"u"&&process.versions&&typeof process.versions.node<"u"&&typeof process.versions.electron>"u";function Dn(a){return a.byteOffset===0&&a.byteLength===a.buffer.byteLength}class Ut{constructor(n){this.typedArray=n instanceof ArrayBuffer||Qe(n)?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}async getLength(){return this.typedArray.byteLength}async read(n,t){return new Uint8Array(this.typedArray.buffer,this.typedArray.byteOffset+n,t)}}class Ft{constructor(n){this.blob=n}async getLength(){return this.blob.size}async read(n,t){const o=this.blob.slice(n,n+t),r=await Zt(o);return new Uint8Array(r)}async sliceAsBlob(n,t,o=""){return this.blob.slice(n,n+t,o)}}function kn(a,n){var t=Uint8Array;if(a[0]==3&&a[1]==0)return n||new t(0);var o=On,r=Jt,l=xn,u=en,f=n==null;f&&(n=new t(a.length>>>2<<3));for(var p=0,h=0,y=0,e=0,i=0,s=0,d=0,m=0,g=0,_,b;p==0;){if(p=o(a,g,1),h=o(a,g+1,2),g+=3,h==0){g&7&&(g+=8-(g&7));var A=(g>>>3)+4,x=a[A-4]|a[A-3]<<8;f&&(n=ft(n,m+x)),n.set(new t(a.buffer,a.byteOffset+A,x),m),g=A+x<<3,m+=x;continue}if(f&&(n=ft(n,m+(1<<17))),h==1&&(_=S.flmap,b=S.fdmap,s=511,d=31),h==2){y=r(a,g,5)+257,e=r(a,g+5,5)+1,i=r(a,g+10,4)+4,g+=14;for(var O=0;O<38;O+=2)S.itree[O]=0,S.itree[O+1]=0;for(var B=1,O=0;O<i;O++){var pe=r(a,g+O*3,3);S.itree[(S.ordr[O]<<1)+1]=pe,pe>B&&(B=pe)}g+=3*i,Ve(S.itree,B),We(S.itree,B,S.imap),_=S.lmap,b=S.dmap,g=l(S.imap,(1<<B)-1,y+e,a,g,S.ttree);var be=Rt(S.ttree,0,y,S.ltree);s=(1<<be)-1;var M=Rt(S.ttree,y,e,S.dtree);d=(1<<M)-1,Ve(S.ltree,be),We(S.ltree,be,_),Ve(S.dtree,M),We(S.dtree,M,b)}for(;;){var Ge=_[u(a,g)&s];g+=Ge&15;var re=Ge>>>4;if(!(re>>>8))n[m++]=re;else{if(re==256)break;var He=m+re-254;if(re>264){var De=S.ldef[re-257];He=m+(De>>>3)+r(a,g,De&7),g+=De&7}var oe=b[u(a,g)&d];g+=oe&15;var ct=oe>>>4,ut=S.ddef[ct],Je=(ut>>>4)+o(a,g,ut&15);for(g+=ut&15,f&&(n=ft(n,m+(1<<17)));m<He;)n[m]=n[m++-Je],n[m]=n[m++-Je],n[m]=n[m++-Je],n[m]=n[m++-Je];m=He}}}return n.length==m?n:n.slice(0,m)}function ft(a,n){var t=a.length;if(n<=t)return a;var o=new Uint8Array(Math.max(t<<1,n));return o.set(a,0),o}function xn(a,n,t,o,r,l){for(var u=Jt,f=en,p=0;p<t;){var h=a[f(o,r)&n];r+=h&15;var y=h>>>4;if(y<=15)l[p]=y,p++;else{var e=0,i=0;y==16?(i=3+u(o,r,2),r+=2,e=l[p-1]):y==17?(i=3+u(o,r,3),r+=3):y==18&&(i=11+u(o,r,7),r+=7);for(var s=p+i;p<s;)l[p]=e,p++}}return r}function Rt(a,n,t,o){for(var r=0,l=0,u=o.length>>>1;l<t;){var f=a[l+n];o[l<<1]=0,o[(l<<1)+1]=f,f>r&&(r=f),l++}for(;l<u;)o[l<<1]=0,o[(l<<1)+1]=0,l++;return r}function Ve(a,n){for(var t=a.length,o,r,l,u,f,p=S.bl_count,u=0;u<=n;u++)p[u]=0;for(u=1;u<t;u+=2)p[a[u]]++;var h=S.next_code;for(o=0,p[0]=0,r=1;r<=n;r++)o=o+p[r-1]<<1,h[r]=o;for(l=0;l<t;l+=2)f=a[l+1],f!=0&&(a[l]=h[f],h[f]++)}function We(a,n,t){for(var o=a.length,r=S.rev15,l=0;l<o;l+=2)if(a[l+1]!=0)for(var u=l>>1,f=a[l+1],p=u<<4|f,h=n-f,y=a[l]<<h,e=y+(1<<h);y!=e;){var i=r[y]>>>15-n;t[i]=p,y++}}function Ct(a,n){for(var t=S.rev15,o=15-n,r=0;r<a.length;r+=2){var l=a[r]<<n-a[r+1];a[r]=t[l]>>>o}}function Jt(a,n,t){return(a[n>>>3]|a[(n>>>3)+1]<<8)>>>(n&7)&(1<<t)-1}function On(a,n,t){return(a[n>>>3]|a[(n>>>3)+1]<<8|a[(n>>>3)+2]<<16)>>>(n&7)&(1<<t)-1}function en(a,n){return(a[n>>>3]|a[(n>>>3)+1]<<8|a[(n>>>3)+2]<<16)>>>(n&7)}const S=function(){var a=Uint16Array,n=Uint32Array;return{next_code:new a(16),bl_count:new a(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new a(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new n(32),flmap:new a(512),fltree:[],fdmap:new a(32),fdtree:[],lmap:new a(32768),ltree:[],ttree:[],dmap:new a(32768),dtree:[],imap:new a(512),itree:[],rev15:new a(32768),lhst:new n(286),dhst:new n(30),ihst:new n(19),lits:new n(15e3),strt:new a(65536),prev:new a(32768)}}();(function(){for(var a=32768,n=0;n<a;n++){var t=n;t=(t&2863311530)>>>1|(t&1431655765)<<1,t=(t&3435973836)>>>2|(t&858993459)<<2,t=(t&4042322160)>>>4|(t&252645135)<<4,t=(t&4278255360)>>>8|(t&16711935)<<8,S.rev15[n]=(t>>>16|t<<16)>>>17}function o(r,l,u){for(;l--!=0;)r.push(0,u)}for(var n=0;n<32;n++)S.ldef[n]=S.of0[n]<<3|S.exb[n],S.ddef[n]=S.df0[n]<<4|S.dxb[n];o(S.fltree,144,8),o(S.fltree,112,9),o(S.fltree,24,7),o(S.fltree,8,8),Ve(S.fltree,9),We(S.fltree,9,S.flmap),Ct(S.fltree,9),o(S.fdtree,32,5),Ve(S.fdtree,5),We(S.fdtree,5,S.fdmap),Ct(S.fdtree,5),o(S.itree,19,0),o(S.ltree,286,0),o(S.dtree,30,0),o(S.ttree,320,0)})();const Bt={table:function(){for(var a=new Uint32Array(256),n=0;n<256;n++){for(var t=n,o=0;o<8;o++)t&1?t=3988292384^t>>>1:t=t>>>1;a[n]=t}return a}(),update:function(a,n,t,o){for(var r=0;r<o;r++)a=Bt.table[(a^n[t+r])&255]^a>>>8;return a},crc:function(a,n,t){return Bt.update(4294967295,a,n,t)^4294967295}};function Pn(a,n){return kn(a,n)}const Nt={numWorkers:1,workerURL:"",useWorkers:!1};let Mn=0;const et=[];function pt(a){return new Promise((n,t)=>{const o=new Worker(a);o.onmessage=r=>{r.data==="start"?(o.onerror=void 0,o.onmessage=void 0,n(o)):t(new Error(`unexpected message: ${r.data}`))},o.onerror=t})}function Ln(a,n){return a.require?a.require(n):{}}(function(){if(En){const{Worker:a}=Ln(module,"worker_threads");return{async createWorker(n){return new a(n)},addEventListener(n,t){n.on("message",o=>{t({target:n,data:o})})},async terminate(n){await n.terminate()}}}else return{async createWorker(a){try{return await pt(a)}catch{console.warn("could not load worker:",a)}let n;try{const t=await fetch(a,{mode:"cors"});if(!t.ok)throw new Error(`could not load: ${a}`);n=await t.text(),a=URL.createObjectURL(new Blob([n],{type:"application/javascript"}));const o=await pt(a);return Nt.workerURL=a,o}catch{console.warn("could not load worker via fetch:",a)}if(n!==void 0)try{a=`data:application/javascript;base64,${btoa(n)}`;const t=await pt(a);return Nt.workerURL=a,t}catch{console.warn("could not load worker via dataURI")}throw console.warn("workers will not be used"),new Error("can not start workers")},addEventListener(a,n){a.addEventListener("message",n)},async terminate(a){a.terminate()}}})();function In(a,n,t,o){const r=new Uint8Array(n);Pn(a,r),o(t?new Blob([r],{type:t}):r.buffer)}async function Un(){if(et.length!==0)for(;et.length;){const{src:a,uncompressedSize:n,type:t,resolve:o}=et.shift();let r=a;Kt(a)&&(r=await Tn(a)),In(r,n,t,o)}}function tn(a,n,t){return new Promise((o,r)=>{et.push({src:a,uncompressedSize:n,type:t,resolve:o,reject:r,id:Mn++}),Un()})}function Fn(a,n){const t=a&31,o=(a>>5&15)-1,r=(a>>9&127)+1980,l=0,u=(n&31)*2,f=n>>5&63,p=n>>11&31;return new Date(r,o,t,p,f,u,l)}class Rn{constructor(n,t){this._reader=n,this._rawEntry=t,this.name=t.name,this.nameBytes=t.nameBytes,this.size=t.uncompressedSize,this.compressedSize=t.compressedSize,this.comment=t.comment,this.commentBytes=t.commentBytes,this.compressionMethod=t.compressionMethod,this.lastModDate=Fn(t.lastModFileDate,t.lastModFileTime),this.isDirectory=t.uncompressedSize===0&&t.name.endsWith("/"),this.encrypted=!!(t.generalPurposeBitFlag&1),this.externalFileAttributes=t.externalFileAttributes,this.versionMadeBy=t.versionMadeBy}async blob(n="application/octet-stream"){return await Xn(this._reader,this._rawEntry,n)}async arrayBuffer(){return await Wn(this._reader,this._rawEntry)}async text(){const n=await this.arrayBuffer();return Xe(new Uint8Array(n))}async json(){const n=await this.text();return JSON.parse(n)}}const ht=22,Cn=65535,Bn=101010256,Nn=101075792;async function qe(a,n,t){return await a.read(n,t)}async function bt(a,n,t,o){return a.sliceAsBlob?await a.sliceAsBlob(n,t,o):await a.read(n,t)}const $n={unsigned(){return 0}};function q(a,n){return a[n]+a[n+1]*256}function V(a,n){return a[n]+a[n+1]*256+a[n+2]*65536+a[n+3]*16777216}function Se(a,n){return V(a,n)+V(a,n+4)*4294967296}const qn=new TextDecoder;function Xe(a,n){return Qe(a.buffer)&&(a=new Uint8Array(a)),qn.decode(a)}async function Gn(a,n){const t=Math.min(ht+Cn,n),o=n-t,r=await qe(a,o,t);for(let l=t-ht;l>=0;--l){if(V(r,l)!==Bn)continue;const u=new Uint8Array(r.buffer,r.byteOffset+l,r.byteLength-l),f=q(u,4);if(f!==0)throw new Error(`multi-volume zip files are not supported. This is volume: ${f}`);const p=q(u,10),h=V(u,12),y=V(u,16),e=q(u,20),i=u.length-ht;if(e!==i)throw new Error(`invalid comment length. expected: ${i}, actual: ${e}`);const s=new Uint8Array(u.buffer,u.byteOffset+22,e),d=Xe(s);return p===65535||y===4294967295?await zn(a,o+l,d,s):await nn(a,y,h,p,d,s)}throw new Error("could not find end of central directory. maybe not zip file")}const Hn=117853008;async function zn(a,n,t,o){const r=n-20,l=await qe(a,r,20);if(V(l,0)!==Hn)throw new Error("invalid zip64 end of central directory locator signature");const u=Se(l,8),f=await qe(a,u,56);if(V(f,0)!==Nn)throw new Error("invalid zip64 end of central directory record signature");const p=Se(f,32),h=Se(f,40),y=Se(f,48);return nn(a,y,h,p,t,o)}const Vn=33639248;async function nn(a,n,t,o,r,l){let u=0;const f=await qe(a,n,t),p=[];for(let y=0;y<o;++y){const e=f.subarray(u,u+46),i=V(e,0);if(i!==Vn)throw new Error(`invalid central directory file header signature: 0x${i.toString(16)}`);const s={versionMadeBy:q(e,4),versionNeededToExtract:q(e,6),generalPurposeBitFlag:q(e,8),compressionMethod:q(e,10),lastModFileTime:q(e,12),lastModFileDate:q(e,14),crc32:V(e,16),compressedSize:V(e,20),uncompressedSize:V(e,24),fileNameLength:q(e,28),extraFieldLength:q(e,30),fileCommentLength:q(e,32),internalFileAttributes:q(e,36),externalFileAttributes:V(e,38),relativeOffsetOfLocalHeader:V(e,42)};if(s.generalPurposeBitFlag&64)throw new Error("strong encryption is not supported");u+=46;const d=f.subarray(u,u+s.fileNameLength+s.extraFieldLength+s.fileCommentLength);s.nameBytes=d.slice(0,s.fileNameLength),s.name=Xe(s.nameBytes);const m=s.fileNameLength+s.extraFieldLength,g=d.slice(s.fileNameLength,m);s.extraFields=[];let _=0;for(;_<g.length-3;){const A=q(g,_+0),x=q(g,_+2),O=_+4,B=O+x;if(B>g.length)throw new Error("extra field length exceeds extra field buffer size");s.extraFields.push({id:A,data:g.slice(O,B)}),_=B}if(s.commentBytes=d.slice(m,m+s.fileCommentLength),s.comment=Xe(s.commentBytes),u+=d.length,s.uncompressedSize===4294967295||s.compressedSize===4294967295||s.relativeOffsetOfLocalHeader===4294967295){const A=s.extraFields.find(B=>B.id===1);if(!A)throw new Error("expected zip64 extended information extra field");const x=A.data;let O=0;if(s.uncompressedSize===4294967295){if(O+8>x.length)throw new Error("zip64 extended information extra field does not include uncompressed size");s.uncompressedSize=Se(x,O),O+=8}if(s.compressedSize===4294967295){if(O+8>x.length)throw new Error("zip64 extended information extra field does not include compressed size");s.compressedSize=Se(x,O),O+=8}if(s.relativeOffsetOfLocalHeader===4294967295){if(O+8>x.length)throw new Error("zip64 extended information extra field does not include relative header offset");s.relativeOffsetOfLocalHeader=Se(x,O),O+=8}}const b=s.extraFields.find(A=>A.id===28789&&A.data.length>=6&&A.data[0]===1&&V(A.data,1),$n.unsigned(s.nameBytes));if(b&&(s.fileName=Xe(b.data.slice(5))),s.compressionMethod===0){let A=s.uncompressedSize;if(s.generalPurposeBitFlag&1&&(A+=12),s.compressedSize!==A)throw new Error(`compressed size mismatch for stored file: ${s.compressedSize} != ${A}`)}p.push(s)}return{zip:{comment:r,commentBytes:l},entries:p.map(y=>new Rn(a,y))}}async function rn(a,n){if(n.generalPurposeBitFlag&1)throw new Error("encrypted entries not supported");const t=await qe(a,n.relativeOffsetOfLocalHeader,30),o=await a.getLength(),r=V(t,0);if(r!==67324752)throw new Error(`invalid local file header signature: 0x${r.toString(16)}`);const l=q(t,26),u=q(t,28),f=n.relativeOffsetOfLocalHeader+t.length+l+u;let p;if(n.compressionMethod===0)p=!1;else if(n.compressionMethod===8)p=!0;else throw new Error(`unsupported compression method: ${n.compressionMethod}`);const h=f,y=h+n.compressedSize;if(n.compressedSize!==0&&y>o)throw new Error(`file data overflows file bounds: ${h} +  ${n.compressedSize}  > ${o}`);return{decompress:p,fileDataStart:h}}async function Wn(a,n){const{decompress:t,fileDataStart:o}=await rn(a,n);if(!t){const u=await qe(a,o,n.compressedSize);return Dn(u)?u.buffer:u.slice().buffer}const r=await bt(a,o,n.compressedSize);return await tn(r,n.uncompressedSize)}async function Xn(a,n,t){const{decompress:o,fileDataStart:r}=await rn(a,n);if(!o){const f=await bt(a,r,n.compressedSize,t);return Kt(f)?f:new Blob([Qe(f.buffer)?new Uint8Array(f):f],{type:t})}const l=await bt(a,r,n.compressedSize);return await tn(l,n.uncompressedSize,t)}async function Yn(a){let n;if(typeof Blob<"u"&&a instanceof Blob)n=new Ft(a);else if(a instanceof ArrayBuffer||a&&a.buffer&&a.buffer instanceof ArrayBuffer)n=new Ut(a);else if(Qe(a)||Qe(a.buffer))n=new Ut(a);else if(typeof a=="string"){const o=await fetch(a);if(!o.ok)throw new Error(`failed http request ${a}, status: ${o.status}: ${o.statusText}`);const r=await o.blob();n=new Ft(r)}else if(typeof a.getLength=="function"&&typeof a.read=="function")n=a;else throw new Error("unsupported source type");const t=await n.getLength();if(t>Number.MAX_SAFE_INTEGER)throw new Error(`file too large. size: ${t}. Only file sizes up 4503599627370496 bytes are supported`);return await Gn(n,t)}var ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ee={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(a){(function(){var n=function(){this.init()};n.prototype={init:function(){var e=this||t;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var i=this||t;if(e=parseFloat(e),i.ctx||y(),typeof e<"u"&&e>=0&&e<=1){if(i._volume=e,i._muted)return i;i.usingWebAudio&&i.masterGain.gain.setValueAtTime(e,t.ctx.currentTime);for(var s=0;s<i._howls.length;s++)if(!i._howls[s]._webAudio)for(var d=i._howls[s]._getSoundIds(),m=0;m<d.length;m++){var g=i._howls[s]._soundById(d[m]);g&&g._node&&(g._node.volume=g._volume*e)}return i}return i._volume},mute:function(e){var i=this||t;i.ctx||y(),i._muted=e,i.usingWebAudio&&i.masterGain.gain.setValueAtTime(e?0:i._volume,t.ctx.currentTime);for(var s=0;s<i._howls.length;s++)if(!i._howls[s]._webAudio)for(var d=i._howls[s]._getSoundIds(),m=0;m<d.length;m++){var g=i._howls[s]._soundById(d[m]);g&&g._node&&(g._node.muted=e?!0:g._muted)}return i},stop:function(){for(var e=this||t,i=0;i<e._howls.length;i++)e._howls[i].stop();return e},unload:function(){for(var e=this||t,i=e._howls.length-1;i>=0;i--)e._howls[i].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,y()),e},codecs:function(e){return(this||t)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||t;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var i=new Audio;typeof i.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var i=new Audio;i.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||t,i=null;try{i=typeof Audio<"u"?new Audio:null}catch{return e}if(!i||typeof i.canPlayType!="function")return e;var s=i.canPlayType("audio/mpeg;").replace(/^no$/,""),d=e._navigator?e._navigator.userAgent:"",m=d.match(/OPR\/(\d+)/g),g=m&&parseInt(m[0].split("/")[1],10)<33,_=d.indexOf("Safari")!==-1&&d.indexOf("Chrome")===-1,b=d.match(/Version\/(.*?) /),A=_&&b&&parseInt(b[1],10)<15;return e._codecs={mp3:!!(!g&&(s||i.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!s,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(i.canPlayType('audio/wav; codecs="1"')||i.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(i.canPlayType("audio/x-m4b;")||i.canPlayType("audio/m4b;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!A&&i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!A&&i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||t;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var i=function(s){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var d=new Audio;d._unlocked=!0,e._releaseHtml5Audio(d)}catch{e.noAudio=!0;break}for(var m=0;m<e._howls.length;m++)if(!e._howls[m]._webAudio)for(var g=e._howls[m]._getSoundIds(),_=0;_<g.length;_++){var b=e._howls[m]._soundById(g[_]);b&&b._node&&!b._node._unlocked&&(b._node._unlocked=!0,b._node.load())}e._autoResume();var A=e.ctx.createBufferSource();A.buffer=e._scratchBuffer,A.connect(e.ctx.destination),typeof A.start>"u"?A.noteOn(0):A.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),A.onended=function(){A.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",i,!0),document.removeEventListener("touchend",i,!0),document.removeEventListener("click",i,!0),document.removeEventListener("keydown",i,!0);for(var x=0;x<e._howls.length;x++)e._howls[x]._emit("unlock")}};return document.addEventListener("touchstart",i,!0),document.addEventListener("touchend",i,!0),document.addEventListener("click",i,!0),document.addEventListener("keydown",i,!0),e}},_obtainHtml5Audio:function(){var e=this||t;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var i=new Audio().play();return i&&typeof Promise<"u"&&(i instanceof Promise||typeof i.then=="function")&&i.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var i=this||t;return e._unlocked&&i._html5AudioPool.push(e),i},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!t.usingWebAudio)){for(var i=0;i<e._howls.length;i++)if(e._howls[i]._webAudio){for(var s=0;s<e._howls[i]._sounds.length;s++)if(!e._howls[i]._sounds[s]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var d=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(d,d)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!t.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var i=0;i<e._howls.length;i++)e._howls[i]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var t=new n,o=function(e){var i=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}i.init(e)};o.prototype={init:function(e){var i=this;return t.ctx||y(),i._autoplay=e.autoplay||!1,i._format=typeof e.format!="string"?e.format:[e.format],i._html5=e.html5||!1,i._muted=e.mute||!1,i._loop=e.loop||!1,i._pool=e.pool||5,i._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,i._rate=e.rate||1,i._sprite=e.sprite||{},i._src=typeof e.src!="string"?e.src:[e.src],i._volume=e.volume!==void 0?e.volume:1,i._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._playLock=!1,i._onend=e.onend?[{fn:e.onend}]:[],i._onfade=e.onfade?[{fn:e.onfade}]:[],i._onload=e.onload?[{fn:e.onload}]:[],i._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],i._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],i._onpause=e.onpause?[{fn:e.onpause}]:[],i._onplay=e.onplay?[{fn:e.onplay}]:[],i._onstop=e.onstop?[{fn:e.onstop}]:[],i._onmute=e.onmute?[{fn:e.onmute}]:[],i._onvolume=e.onvolume?[{fn:e.onvolume}]:[],i._onrate=e.onrate?[{fn:e.onrate}]:[],i._onseek=e.onseek?[{fn:e.onseek}]:[],i._onunlock=e.onunlock?[{fn:e.onunlock}]:[],i._onresume=[],i._webAudio=t.usingWebAudio&&!i._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(i),i._autoplay&&i._queue.push({event:"play",action:function(){i.play()}}),i._preload&&i._preload!=="none"&&i.load(),i},load:function(){var e=this,i=null;if(t.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var s=0;s<e._src.length;s++){var d,m;if(e._format&&e._format[s])d=e._format[s];else{if(m=e._src[s],typeof m!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}d=/^data:audio\/([^;,]+);/i.exec(m),d||(d=/\.([^.]+)$/.exec(m.split("?",1)[0])),d&&(d=d[1].toLowerCase())}if(d||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),d&&t.codecs(d)){i=e._src[s];break}}if(!i){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=i,e._state="loading",window.location.protocol==="https:"&&i.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new r(e),e._webAudio&&u(e),e},play:function(e,i){var s=this,d=null;if(typeof e=="number")d=e,e=null;else{if(typeof e=="string"&&s._state==="loaded"&&!s._sprite[e])return null;if(typeof e>"u"&&(e="__default",!s._playLock)){for(var m=0,g=0;g<s._sounds.length;g++)s._sounds[g]._paused&&!s._sounds[g]._ended&&(m++,d=s._sounds[g]._id);m===1?e=null:d=null}}var _=d?s._soundById(d):s._inactiveSound();if(!_)return null;if(d&&!e&&(e=_._sprite||"__default"),s._state!=="loaded"){_._sprite=e,_._ended=!1;var b=_._id;return s._queue.push({event:"play",action:function(){s.play(b)}}),b}if(d&&!_._paused)return i||s._loadQueue("play"),_._id;s._webAudio&&t._autoResume();var A=Math.max(0,_._seek>0?_._seek:s._sprite[e][0]/1e3),x=Math.max(0,(s._sprite[e][0]+s._sprite[e][1])/1e3-A),O=x*1e3/Math.abs(_._rate),B=s._sprite[e][0]/1e3,pe=(s._sprite[e][0]+s._sprite[e][1])/1e3;_._sprite=e,_._ended=!1;var be=function(){_._paused=!1,_._seek=A,_._start=B,_._stop=pe,_._loop=!!(_._loop||s._sprite[e][2])};if(A>=pe){s._ended(_);return}var M=_._node;if(s._webAudio){var Ge=function(){s._playLock=!1,be(),s._refreshBuffer(_);var oe=_._muted||s._muted?0:_._volume;M.gain.setValueAtTime(oe,t.ctx.currentTime),_._playStart=t.ctx.currentTime,typeof M.bufferSource.start>"u"?_._loop?M.bufferSource.noteGrainOn(0,A,86400):M.bufferSource.noteGrainOn(0,A,x):_._loop?M.bufferSource.start(0,A,86400):M.bufferSource.start(0,A,x),O!==1/0&&(s._endTimers[_._id]=setTimeout(s._ended.bind(s,_),O)),i||setTimeout(function(){s._emit("play",_._id),s._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?Ge():(s._playLock=!0,s.once("resume",Ge),s._clearTimer(_._id))}else{var re=function(){M.currentTime=A,M.muted=_._muted||s._muted||t._muted||M.muted,M.volume=_._volume*t.volume(),M.playbackRate=_._rate;try{var oe=M.play();if(oe&&typeof Promise<"u"&&(oe instanceof Promise||typeof oe.then=="function")?(s._playLock=!0,be(),oe.then(function(){s._playLock=!1,M._unlocked=!0,i?s._loadQueue():s._emit("play",_._id)}).catch(function(){s._playLock=!1,s._emit("playerror",_._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),_._ended=!0,_._paused=!0})):i||(s._playLock=!1,be(),s._emit("play",_._id)),M.playbackRate=_._rate,M.paused){s._emit("playerror",_._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||_._loop?s._endTimers[_._id]=setTimeout(s._ended.bind(s,_),O):(s._endTimers[_._id]=function(){s._ended(_),M.removeEventListener("ended",s._endTimers[_._id],!1)},M.addEventListener("ended",s._endTimers[_._id],!1))}catch(ct){s._emit("playerror",_._id,ct)}};M.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(M.src=s._src,M.load());var He=window&&window.ejecta||!M.readyState&&t._navigator.isCocoonJS;if(M.readyState>=3||He)re();else{s._playLock=!0,s._state="loading";var De=function(){s._state="loaded",re(),M.removeEventListener(t._canPlayEvent,De,!1)};M.addEventListener(t._canPlayEvent,De,!1),s._clearTimer(_._id)}}return _._id},pause:function(e){var i=this;if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"pause",action:function(){i.pause(e)}}),i;for(var s=i._getSoundIds(e),d=0;d<s.length;d++){i._clearTimer(s[d]);var m=i._soundById(s[d]);if(m&&!m._paused&&(m._seek=i.seek(s[d]),m._rateSeek=0,m._paused=!0,i._stopFade(s[d]),m._node))if(i._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),i._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||i._emit("pause",m?m._id:null)}return i},stop:function(e,i){var s=this;if(s._state!=="loaded"||s._playLock)return s._queue.push({event:"stop",action:function(){s.stop(e)}}),s;for(var d=s._getSoundIds(e),m=0;m<d.length;m++){s._clearTimer(d[m]);var g=s._soundById(d[m]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,s._stopFade(d[m]),g._node&&(s._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),s._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&s._clearSound(g._node))),i||s._emit("stop",g._id))}return s},mute:function(e,i){var s=this;if(s._state!=="loaded"||s._playLock)return s._queue.push({event:"mute",action:function(){s.mute(e,i)}}),s;if(typeof i>"u")if(typeof e=="boolean")s._muted=e;else return s._muted;for(var d=s._getSoundIds(i),m=0;m<d.length;m++){var g=s._soundById(d[m]);g&&(g._muted=e,g._interval&&s._stopFade(g._id),s._webAudio&&g._node?g._node.gain.setValueAtTime(e?0:g._volume,t.ctx.currentTime):g._node&&(g._node.muted=t._muted?!0:e),s._emit("mute",g._id))}return s},volume:function(){var e=this,i=arguments,s,d;if(i.length===0)return e._volume;if(i.length===1||i.length===2&&typeof i[1]>"u"){var m=e._getSoundIds(),g=m.indexOf(i[0]);g>=0?d=parseInt(i[0],10):s=parseFloat(i[0])}else i.length>=2&&(s=parseFloat(i[0]),d=parseInt(i[1],10));var _;if(typeof s<"u"&&s>=0&&s<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,i)}}),e;typeof d>"u"&&(e._volume=s),d=e._getSoundIds(d);for(var b=0;b<d.length;b++)_=e._soundById(d[b]),_&&(_._volume=s,i[2]||e._stopFade(d[b]),e._webAudio&&_._node&&!_._muted?_._node.gain.setValueAtTime(s,t.ctx.currentTime):_._node&&!_._muted&&(_._node.volume=s*t.volume()),e._emit("volume",_._id))}else return _=d?e._soundById(d):e._sounds[0],_?_._volume:0;return e},fade:function(e,i,s,d){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(e,i,s,d)}}),m;e=Math.min(Math.max(0,parseFloat(e)),1),i=Math.min(Math.max(0,parseFloat(i)),1),s=parseFloat(s),m.volume(e,d);for(var g=m._getSoundIds(d),_=0;_<g.length;_++){var b=m._soundById(g[_]);if(b){if(d||m._stopFade(g[_]),m._webAudio&&!b._muted){var A=t.ctx.currentTime,x=A+s/1e3;b._volume=e,b._node.gain.setValueAtTime(e,A),b._node.gain.linearRampToValueAtTime(i,x)}m._startFadeInterval(b,e,i,s,g[_],typeof d>"u")}}return m},_startFadeInterval:function(e,i,s,d,m,g){var _=this,b=i,A=s-i,x=Math.abs(A/.01),O=Math.max(4,x>0?d/x:d),B=Date.now();e._fadeTo=s,e._interval=setInterval(function(){var pe=(Date.now()-B)/d;B=Date.now(),b+=A*pe,b=Math.round(b*100)/100,A<0?b=Math.max(s,b):b=Math.min(s,b),_._webAudio?e._volume=b:_.volume(b,e._id,!0),g&&(_._volume=b),(s<i&&b<=s||s>i&&b>=s)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,_.volume(s,e._id),_._emit("fade",e._id))},O)},_stopFade:function(e){var i=this,s=i._soundById(e);return s&&s._interval&&(i._webAudio&&s._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(s._interval),s._interval=null,i.volume(s._fadeTo,e),s._fadeTo=null,i._emit("fade",e)),i},loop:function(){var e=this,i=arguments,s,d,m;if(i.length===0)return e._loop;if(i.length===1)if(typeof i[0]=="boolean")s=i[0],e._loop=s;else return m=e._soundById(parseInt(i[0],10)),m?m._loop:!1;else i.length===2&&(s=i[0],d=parseInt(i[1],10));for(var g=e._getSoundIds(d),_=0;_<g.length;_++)m=e._soundById(g[_]),m&&(m._loop=s,e._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=s,s&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,e.playing(g[_])&&(e.pause(g[_],!0),e.play(g[_],!0)))));return e},rate:function(){var e=this,i=arguments,s,d;if(i.length===0)d=e._sounds[0]._id;else if(i.length===1){var m=e._getSoundIds(),g=m.indexOf(i[0]);g>=0?d=parseInt(i[0],10):s=parseFloat(i[0])}else i.length===2&&(s=parseFloat(i[0]),d=parseInt(i[1],10));var _;if(typeof s=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,i)}}),e;typeof d>"u"&&(e._rate=s),d=e._getSoundIds(d);for(var b=0;b<d.length;b++)if(_=e._soundById(d[b]),_){e.playing(d[b])&&(_._rateSeek=e.seek(d[b]),_._playStart=e._webAudio?t.ctx.currentTime:_._playStart),_._rate=s,e._webAudio&&_._node&&_._node.bufferSource?_._node.bufferSource.playbackRate.setValueAtTime(s,t.ctx.currentTime):_._node&&(_._node.playbackRate=s);var A=e.seek(d[b]),x=(e._sprite[_._sprite][0]+e._sprite[_._sprite][1])/1e3-A,O=x*1e3/Math.abs(_._rate);(e._endTimers[d[b]]||!_._paused)&&(e._clearTimer(d[b]),e._endTimers[d[b]]=setTimeout(e._ended.bind(e,_),O)),e._emit("rate",_._id)}}else return _=e._soundById(d),_?_._rate:e._rate;return e},seek:function(){var e=this,i=arguments,s,d;if(i.length===0)e._sounds.length&&(d=e._sounds[0]._id);else if(i.length===1){var m=e._getSoundIds(),g=m.indexOf(i[0]);g>=0?d=parseInt(i[0],10):e._sounds.length&&(d=e._sounds[0]._id,s=parseFloat(i[0]))}else i.length===2&&(s=parseFloat(i[0]),d=parseInt(i[1],10));if(typeof d>"u")return 0;if(typeof s=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,i)}}),e;var _=e._soundById(d);if(_)if(typeof s=="number"&&s>=0){var b=e.playing(d);b&&e.pause(d,!0),_._seek=s,_._ended=!1,e._clearTimer(d),!e._webAudio&&_._node&&!isNaN(_._node.duration)&&(_._node.currentTime=s);var A=function(){b&&e.play(d,!0),e._emit("seek",d)};if(b&&!e._webAudio){var x=function(){e._playLock?setTimeout(x,0):A()};setTimeout(x,0)}else A()}else if(e._webAudio){var O=e.playing(d)?t.ctx.currentTime-_._playStart:0,B=_._rateSeek?_._rateSeek-_._seek:0;return _._seek+(B+O*Math.abs(_._rate))}else return _._node.currentTime;return e},playing:function(e){var i=this;if(typeof e=="number"){var s=i._soundById(e);return s?!s._paused:!1}for(var d=0;d<i._sounds.length;d++)if(!i._sounds[d]._paused)return!0;return!1},duration:function(e){var i=this,s=i._duration,d=i._soundById(e);return d&&(s=i._sprite[d._sprite][1]/1e3),s},state:function(){return this._state},unload:function(){for(var e=this,i=e._sounds,s=0;s<i.length;s++)i[s]._paused||e.stop(i[s]._id),e._webAudio||(e._clearSound(i[s]._node),i[s]._node.removeEventListener("error",i[s]._errorFn,!1),i[s]._node.removeEventListener(t._canPlayEvent,i[s]._loadFn,!1),i[s]._node.removeEventListener("ended",i[s]._endFn,!1),t._releaseHtml5Audio(i[s]._node)),delete i[s]._node,e._clearTimer(i[s]._id);var d=t._howls.indexOf(e);d>=0&&t._howls.splice(d,1);var m=!0;for(s=0;s<t._howls.length;s++)if(t._howls[s]._src===e._src||e._src.indexOf(t._howls[s]._src)>=0){m=!1;break}return l&&m&&delete l[e._src],t.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,i,s,d){var m=this,g=m["_on"+e];return typeof i=="function"&&g.push(d?{id:s,fn:i,once:d}:{id:s,fn:i}),m},off:function(e,i,s){var d=this,m=d["_on"+e],g=0;if(typeof i=="number"&&(s=i,i=null),i||s)for(g=0;g<m.length;g++){var _=s===m[g].id;if(i===m[g].fn&&_||!i&&_){m.splice(g,1);break}}else if(e)d["_on"+e]=[];else{var b=Object.keys(d);for(g=0;g<b.length;g++)b[g].indexOf("_on")===0&&Array.isArray(d[b[g]])&&(d[b[g]]=[])}return d},once:function(e,i,s){var d=this;return d.on(e,i,s,1),d},_emit:function(e,i,s){for(var d=this,m=d["_on"+e],g=m.length-1;g>=0;g--)(!m[g].id||m[g].id===i||e==="load")&&(setTimeout((function(_){_.call(this,i,s)}).bind(d,m[g].fn),0),m[g].once&&d.off(e,m[g].fn,m[g].id));return d._loadQueue(e),d},_loadQueue:function(e){var i=this;if(i._queue.length>0){var s=i._queue[0];s.event===e&&(i._queue.shift(),i._loadQueue()),e||s.action()}return i},_ended:function(e){var i=this,s=e._sprite;if(!i._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(i._ended.bind(i,e),100),i;var d=!!(e._loop||i._sprite[s][2]);if(i._emit("end",e._id),!i._webAudio&&d&&i.stop(e._id,!0).play(e._id),i._webAudio&&d){i._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=t.ctx.currentTime;var m=(e._stop-e._start)*1e3/Math.abs(e._rate);i._endTimers[e._id]=setTimeout(i._ended.bind(i,e),m)}return i._webAudio&&!d&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,i._clearTimer(e._id),i._cleanBuffer(e._node),t._autoSuspend()),!i._webAudio&&!d&&i.stop(e._id,!0),i},_clearTimer:function(e){var i=this;if(i._endTimers[e]){if(typeof i._endTimers[e]!="function")clearTimeout(i._endTimers[e]);else{var s=i._soundById(e);s&&s._node&&s._node.removeEventListener("ended",i._endTimers[e],!1)}delete i._endTimers[e]}return i},_soundById:function(e){for(var i=this,s=0;s<i._sounds.length;s++)if(e===i._sounds[s]._id)return i._sounds[s];return null},_inactiveSound:function(){var e=this;e._drain();for(var i=0;i<e._sounds.length;i++)if(e._sounds[i]._ended)return e._sounds[i].reset();return new r(e)},_drain:function(){var e=this,i=e._pool,s=0,d=0;if(!(e._sounds.length<i)){for(d=0;d<e._sounds.length;d++)e._sounds[d]._ended&&s++;for(d=e._sounds.length-1;d>=0;d--){if(s<=i)return;e._sounds[d]._ended&&(e._webAudio&&e._sounds[d]._node&&e._sounds[d]._node.disconnect(0),e._sounds.splice(d,1),s--)}}},_getSoundIds:function(e){var i=this;if(typeof e>"u"){for(var s=[],d=0;d<i._sounds.length;d++)s.push(i._sounds[d]._id);return s}else return[e]},_refreshBuffer:function(e){var i=this;return e._node.bufferSource=t.ctx.createBufferSource(),e._node.bufferSource.buffer=l[i._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,t.ctx.currentTime),i},_cleanBuffer:function(e){var i=this,s=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return i;if(t._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),s))try{e.bufferSource.buffer=t._scratchBuffer}catch{}return e.bufferSource=null,i},_clearSound:function(e){var i=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);i||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(e){this._parent=e,this.init()};r.prototype={init:function(){var e=this,i=e._parent;return e._muted=i._muted,e._loop=i._loop,e._volume=i._volume,e._rate=i._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,i._sounds.push(e),e.create(),e},create:function(){var e=this,i=e._parent,s=t._muted||e._muted||e._parent._muted?0:e._volume;return i._webAudio?(e._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),e._node.gain.setValueAtTime(s,t.ctx.currentTime),e._node.paused=!0,e._node.connect(t.masterGain)):t.noAudio||(e._node=t._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(t._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=i._src,e._node.preload=i._preload===!0?"auto":i._preload,e._node.volume=s*t.volume(),e._node.load()),e},reset:function(){var e=this,i=e._parent;return e._muted=i._muted,e._loop=i._loop,e._volume=i._volume,e._rate=i._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,i=e._parent;i._duration=Math.ceil(e._node.duration*10)/10,Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue()),e._node.removeEventListener(t._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,i=e._parent;i._duration===1/0&&(i._duration=Math.ceil(e._node.duration*10)/10,i._sprite.__default[1]===1/0&&(i._sprite.__default[1]=i._duration*1e3),i._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var l={},u=function(e){var i=e._src;if(l[i]){e._duration=l[i].duration,h(e);return}if(/^data:[^;]+;base64,/.test(i)){for(var s=atob(i.split(",")[1]),d=new Uint8Array(s.length),m=0;m<s.length;++m)d[m]=s.charCodeAt(m);p(d.buffer,e)}else{var g=new XMLHttpRequest;g.open(e._xhr.method,i,!0),g.withCredentials=e._xhr.withCredentials,g.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(_){g.setRequestHeader(_,e._xhr.headers[_])}),g.onload=function(){var _=(g.status+"")[0];if(_!=="0"&&_!=="2"&&_!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}p(g.response,e)},g.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete l[i],e.load())},f(g)}},f=function(e){try{e.send()}catch{e.onerror()}},p=function(e,i){var s=function(){i._emit("loaderror",null,"Decoding audio data failed.")},d=function(m){m&&i._sounds.length>0?(l[i._src]=m,h(i,m)):s()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(e).then(d).catch(s):t.ctx.decodeAudioData(e,d,s)},h=function(e,i){i&&!e._duration&&(e._duration=i.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},y=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),i=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),s=i?parseInt(i[1],10):null;if(e&&s&&s<9){var d=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!d&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};a.Howler=t,a.Howl=o,typeof ze<"u"?(ze.HowlerGlobal=n,ze.Howler=t,ze.Howl=o,ze.Sound=r):typeof window<"u"&&(window.HowlerGlobal=n,window.Howler=t,window.Howl=o,window.Sound=r)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var o=this;if(!o.ctx||!o.ctx.listener)return o;for(var r=o._howls.length-1;r>=0;r--)o._howls[r].stereo(t);return o},HowlerGlobal.prototype.pos=function(t,o,r){var l=this;if(!l.ctx||!l.ctx.listener)return l;if(o=typeof o!="number"?l._pos[1]:o,r=typeof r!="number"?l._pos[2]:r,typeof t=="number")l._pos=[t,o,r],typeof l.ctx.listener.positionX<"u"?(l.ctx.listener.positionX.setTargetAtTime(l._pos[0],Howler.ctx.currentTime,.1),l.ctx.listener.positionY.setTargetAtTime(l._pos[1],Howler.ctx.currentTime,.1),l.ctx.listener.positionZ.setTargetAtTime(l._pos[2],Howler.ctx.currentTime,.1)):l.ctx.listener.setPosition(l._pos[0],l._pos[1],l._pos[2]);else return l._pos;return l},HowlerGlobal.prototype.orientation=function(t,o,r,l,u,f){var p=this;if(!p.ctx||!p.ctx.listener)return p;var h=p._orientation;if(o=typeof o!="number"?h[1]:o,r=typeof r!="number"?h[2]:r,l=typeof l!="number"?h[3]:l,u=typeof u!="number"?h[4]:u,f=typeof f!="number"?h[5]:f,typeof t=="number")p._orientation=[t,o,r,l,u,f],typeof p.ctx.listener.forwardX<"u"?(p.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),p.ctx.listener.forwardY.setTargetAtTime(o,Howler.ctx.currentTime,.1),p.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),p.ctx.listener.upX.setTargetAtTime(l,Howler.ctx.currentTime,.1),p.ctx.listener.upY.setTargetAtTime(u,Howler.ctx.currentTime,.1),p.ctx.listener.upZ.setTargetAtTime(f,Howler.ctx.currentTime,.1)):p.ctx.listener.setOrientation(t,o,r,l,u,f);else return h;return p},Howl.prototype.init=function(t){return function(o){var r=this;return r._orientation=o.orientation||[1,0,0],r._stereo=o.stereo||null,r._pos=o.pos||null,r._pannerAttr={coneInnerAngle:typeof o.coneInnerAngle<"u"?o.coneInnerAngle:360,coneOuterAngle:typeof o.coneOuterAngle<"u"?o.coneOuterAngle:360,coneOuterGain:typeof o.coneOuterGain<"u"?o.coneOuterGain:0,distanceModel:typeof o.distanceModel<"u"?o.distanceModel:"inverse",maxDistance:typeof o.maxDistance<"u"?o.maxDistance:1e4,panningModel:typeof o.panningModel<"u"?o.panningModel:"HRTF",refDistance:typeof o.refDistance<"u"?o.refDistance:1,rolloffFactor:typeof o.rolloffFactor<"u"?o.rolloffFactor:1},r._onstereo=o.onstereo?[{fn:o.onstereo}]:[],r._onpos=o.onpos?[{fn:o.onpos}]:[],r._onorientation=o.onorientation?[{fn:o.onorientation}]:[],t.call(this,o)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,o){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(t,o)}}),r;var l=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof o>"u")if(typeof t=="number")r._stereo=t,r._pos=[t,0,0];else return r._stereo;for(var u=r._getSoundIds(o),f=0;f<u.length;f++){var p=r._soundById(u[f]);if(p)if(typeof t=="number")p._stereo=t,p._pos=[t,0,0],p._node&&(p._pannerAttr.panningModel="equalpower",(!p._panner||!p._panner.pan)&&n(p,l),l==="spatial"?typeof p._panner.positionX<"u"?(p._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),p._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),p._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):p._panner.setPosition(t,0,0):p._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit("stereo",p._id);else return p._stereo}return r},Howl.prototype.pos=function(t,o,r,l){var u=this;if(!u._webAudio)return u;if(u._state!=="loaded")return u._queue.push({event:"pos",action:function(){u.pos(t,o,r,l)}}),u;if(o=typeof o!="number"?0:o,r=typeof r!="number"?-.5:r,typeof l>"u")if(typeof t=="number")u._pos=[t,o,r];else return u._pos;for(var f=u._getSoundIds(l),p=0;p<f.length;p++){var h=u._soundById(f[p]);if(h)if(typeof t=="number")h._pos=[t,o,r],h._node&&((!h._panner||h._panner.pan)&&n(h,"spatial"),typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(o,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setPosition(t,o,r)),u._emit("pos",h._id);else return h._pos}return u},Howl.prototype.orientation=function(t,o,r,l){var u=this;if(!u._webAudio)return u;if(u._state!=="loaded")return u._queue.push({event:"orientation",action:function(){u.orientation(t,o,r,l)}}),u;if(o=typeof o!="number"?u._orientation[1]:o,r=typeof r!="number"?u._orientation[2]:r,typeof l>"u")if(typeof t=="number")u._orientation=[t,o,r];else return u._orientation;for(var f=u._getSoundIds(l),p=0;p<f.length;p++){var h=u._soundById(f[p]);if(h)if(typeof t=="number")h._orientation=[t,o,r],h._node&&(h._panner||(h._pos||(h._pos=u._pos||[0,0,-.5]),n(h,"spatial")),typeof h._panner.orientationX<"u"?(h._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(o,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setOrientation(t,o,r)),u._emit("orientation",h._id);else return h._orientation}return u},Howl.prototype.pannerAttr=function(){var t=this,o=arguments,r,l,u;if(!t._webAudio)return t;if(o.length===0)return t._pannerAttr;if(o.length===1)if(typeof o[0]=="object")r=o[0],typeof l>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),t._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:t._panningModel});else return u=t._soundById(parseInt(o[0],10)),u?u._pannerAttr:t._pannerAttr;else o.length===2&&(r=o[0],l=parseInt(o[1],10));for(var f=t._getSoundIds(l),p=0;p<f.length;p++)if(u=t._soundById(f[p]),u){var h=u._pannerAttr;h={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:h.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:h.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:h.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:h.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:h.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:h.panningModel};var y=u._panner;y||(u._pos||(u._pos=t._pos||[0,0,-.5]),n(u,"spatial"),y=u._panner),y.coneInnerAngle=h.coneInnerAngle,y.coneOuterAngle=h.coneOuterAngle,y.coneOuterGain=h.coneOuterGain,y.distanceModel=h.distanceModel,y.maxDistance=h.maxDistance,y.refDistance=h.refDistance,y.rolloffFactor=h.rolloffFactor,y.panningModel=h.panningModel}return t},Sound.prototype.init=function(t){return function(){var o=this,r=o._parent;o._orientation=r._orientation,o._stereo=r._stereo,o._pos=r._pos,o._pannerAttr=r._pannerAttr,t.call(this),o._stereo?r.stereo(o._stereo):o._pos&&r.pos(o._pos[0],o._pos[1],o._pos[2],o._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var o=this,r=o._parent;return o._orientation=r._orientation,o._stereo=r._stereo,o._pos=r._pos,o._pannerAttr=r._pannerAttr,o._stereo?r.stereo(o._stereo):o._pos?r.pos(o._pos[0],o._pos[1],o._pos[2],o._id):o._panner&&(o._panner.disconnect(0),o._panner=void 0,r._refreshBuffer(o)),t.call(this)}}(Sound.prototype.reset);var n=function(t,o){o=o||"spatial",o==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(Ee);const Qn={repeatCount:-1,stereoSeparation:100,interpolationFilter:0,context:!1};class Dt{constructor(n){if(this.config={...Qn,...n},this.config.context){if(!this.config.context.destination)throw"ChiptuneJsPlayer: This is not an audio context";this.context=this.config.context,this.destination=!1}else this.context=new AudioContext,this.destination=this.context.destination;delete this.config.context,this.gain=this.context.createGain(),this.gain.gain.value=1,this.handlers=[],this.context.audioWorklet.addModule(new URL("./chiptune3.worklet-DFNNdNeT.js",import.meta.url)).then(()=>{this.processNode=new AudioWorkletNode(this.context,"libopenmpt-processor",{numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[2]}),this.processNode.port.onmessage=this.handleMessage_.bind(this),this.processNode.port.postMessage({cmd:"config",val:this.config}),this.fireEvent("onInitialized"),this.processNode.connect(this.gain),this.destination&&this.gain.connect(this.destination)}).catch(t=>console.error(t))}handleMessage_(n){switch(n.data.cmd){case"meta":this.meta=n.data.meta,this.duration=n.data.meta.dur,this.fireEvent("onMetadata",this.meta);break;case"pos":this.currentTime=n.data.pos,this.order=n.data.order,this.pattern=n.data.pattern,this.row=n.data.row,this.fireEvent("onProgress",n.data);break;case"end":this.fireEvent("onEnded");break;case"err":this.fireEvent("onError",{type:n.data.val});break;default:console.log("Received unknown message",n.data)}}fireEvent(n,t){const o=this.handlers;o.length&&o.forEach(function(r){r.eventName===n&&r.handler(t)})}addHandler(n,t){this.handlers.push({eventName:n,handler:t})}onInitialized(n){this.addHandler("onInitialized",n)}onEnded(n){this.addHandler("onEnded",n)}onError(n){this.addHandler("onError",n)}onMetadata(n){this.addHandler("onMetadata",n)}onProgress(n){this.addHandler("onProgress",n)}postMsg(n,t){this.processNode&&this.processNode.port.postMessage({cmd:n,val:t})}load(n){fetch(n).then(t=>t.arrayBuffer()).then(t=>this.play(t)).catch(t=>{this.fireEvent("onError",{type:"Load"})})}play(n){this.postMsg("play",n)}stop(){this.postMsg("stop")}pause(){this.postMsg("pause")}unpause(){this.postMsg("unpause")}togglePause(){this.postMsg("togglePause")}setRepeatCount(n){this.postMsg("repeatCount",n)}setPitch(n){this.postMsg("setPitch",n)}setTempo(n){this.postMsg("setTempo",n)}setPos(n){this.postMsg("setPos",n)}setOrderRow(n,t){this.postMsg("setOrderRow",{o:n,r:t})}setVol(n){this.gain.gain.value=n}selectSubsong(n){this.postMsg("selectSubsong",n)}seek(n){this.setPos(n)}getCurrentTime(){return this.currentTime}}var Ie,Ke,rt,on,ot,an;const at=class at{constructor(){w(this,rt);w(this,Ie,{});w(this,Ke,new Set)}toFatPath(n){var o;const t=(n.startsWith("/")||n.startsWith("\\")?n.substring(1):n).split(/[\\/]/).map(r=>r.toUpperCase());return D(o=at,ot,an).call(o,t).map(r=>{if(!c(this,Ie)[r]){const l=D(this,rt,on).call(this,r);c(this,Ie)[r]=l}return c(this,Ie)[r]}).join("\\")}};Ie=new WeakMap,Ke=new WeakMap,rt=new WeakSet,on=function(n){const t=n.replace(/[\\/:*?"<>|]/g,""),o=t.lastIndexOf("."),r=(o===-1?t:t.slice(0,o)).slice(0,8),l=(o===-1?"":t.slice(o+1)).slice(0,3);let u=`${r}.${l}`.replace(/\.$/,""),f=1;for(;c(this,Ke).has(u);){const p=`~${f}`;u=`${r.slice(0,8-p.length)}${p}.${l}`.replace(/\.$/,""),f++}return c(this,Ke).add(u),u},ot=new WeakSet,an=function(n){return n.reduce((t,o)=>(o===".."?t.pop():o!=="."&&o!==""&&t.push(o),t),[])},w(at,ot);let vt=at;async function sn(a){if("url"in a)return await async function(n){const t=await fetch(n),o=await t.arrayBuffer();return new Uint8Array(o)}(a.url);if("array"in a)return a.array;if("buffer"in a)return new Uint8Array(a.buffer);throw new Error("Unrecognized contents")}function $t(a){const n=a.split("/"),t=[];let o="";for(let r=0;r<n.length-1;r++)o=o?`${o}/${n[r]}`:n[r],t.push(o);return t}async function jn(a){const n=await sn(a),t=await Yn(n),o=await Promise.all(t.entries.map(async p=>({name:p.name,contents:p.name.endsWith("/")?null:new Uint8Array(await p.arrayBuffer())}))),{image:r,disk:l}=await async function(p){const h=new Uint8Array(p),y=await Ye.create(h);return y.mkfs({fmt:yt.FAT,nFat:2,auSize:2048}),{image:h,disk:y}}(1<<25);l.mount();const u=new vt,f=new Set;for(const{name:p,contents:h}of o)try{if(h===null){for(const e of $t(p)){const i=e.endsWith("/")?e.substring(0,e.length-1):e;f.has(i)||(l.mkdir(u.toFatPath(i)),f.add(i))}const y=p.endsWith("/")?p.substring(0,p.length-1):p;f.has(y)||(l.mkdir(u.toFatPath(y)),f.add(y))}else{for(const y of $t(p)){const e=y.endsWith("/")?y.substring(0,y.length-1):y;f.has(e)||(l.mkdir(u.toFatPath(e)),f.add(e))}if(!f.has(p)){f.add(p);const y=l.open(u.toFatPath(p),Te.WRITE|Te.CREATE_NEW);y.write(h),y.close()}}}catch(y){console.log(`Failed to create '${p}':`,y)}return l.unmount(),{image:r,disk:l,pathMap:u}}const Z=65535,qt=16777215,K=65534,Gt=16777214;var E,N;(function(a){a[a.Initialize=0]="Initialize",a[a.Close=1]="Close",a[a.Reset=2]="Reset",a[a.LoadSnd=3]="LoadSnd",a[a.PlaySnd=4]="PlaySnd",a[a.SetSndAttr=5]="SetSndAttr",a[a.GetSndAttr=6]="GetSndAttr",a[a.LoadMusic=7]="LoadMusic",a[a.PlayMusic=8]="PlayMusic",a[a.SetMusicAttr=9]="SetMusicAttr",a[a.GetMusicAttr=10]="GetMusicAttr",a[a.StopSnd=11]="StopSnd",a[a.PauseMusic=12]="PauseMusic",a[a.ResumeMusic=13]="ResumeMusic",a[a.StopMusic=14]="StopMusic",a[a.DeleteSnd=15]="DeleteSnd",a[a.DeleteMusic=16]="DeleteMusic",a[a.SetVolume=17]="SetVolume",a[a.SetGlobalVols=18]="SetGlobalVols",a[a.Play2DSounds=19]="Play2DSounds",a[a.Play3DSounds=20]="Play3DSounds",a[a.GetMusicLength=21]="GetMusicLength",a[a.SetMusicPos=22]="SetMusicPos",a[a.GetMusicPos=23]="GetMusicPos",a[a.Set3DPos=24]="Set3DPos",a[a.PlaySnd3D=25]="PlaySnd3D",a[a.Set3DFacts=26]="Set3DFacts",a[a.SetEAX=27]="SetEAX",a[a.PlaySounds=28]="PlaySounds",a[a.PlaySnd2D=29]="PlaySnd2D",a[a.Set2DPos=30]="Set2DPos",a[a.Set2DDistFactor=31]="Set2DDistFactor",a[a.CDInit=32]="CDInit",a[a.CDFree=33]="CDFree",a[a.GetTracks=34]="GetTracks",a[a.GetTrackLength=35]="GetTrackLength",a[a.CDPlay=36]="CDPlay"})(E||(E={}));var J,Ue,_e,G,R,me,ie,se,Ae,U,wt,St,At,xe,tt,ln;class Zn{constructor(n,t){w(this,U);w(this,J);w(this,Ue);w(this,_e);w(this,G);w(this,R);w(this,me);w(this,ie);w(this,se);w(this,Ae);v(this,J,n),v(this,Ue,void 0),v(this,_e,t??""),v(this,G,{}),v(this,R,{}),v(this,me,100),v(this,ie,{sound:100,music:100}),v(this,se,{x:0,y:0,angle:0}),v(this,Ae,1)}start(){v(this,Ue,setInterval(()=>{if(c(this,J).poll()!==0)try{const n=c(this,J).read(`${c(this,_e)}\\DS4QB.QBW`);D(this,U,ln).call(this,n).then(t=>{t&&c(this,J).write(`${c(this,_e)}\\DS4QB.VCW`,t),c(this,J).clear()})}catch{console.error(`DS4QB++: Unable to read '${c(this,_e)}\\DS4QB.QBW'`),c(this,J).clear()}},2))}stop(){clearInterval(c(this,Ue))}}J=new WeakMap,Ue=new WeakMap,_e=new WeakMap,G=new WeakMap,R=new WeakMap,me=new WeakMap,ie=new WeakMap,se=new WeakMap,Ae=new WeakMap,U=new WeakSet,wt=function(n){const t=n.indexOf(0),o=t===-1?n:n.subarray(0,t),r=new TextDecoder().decode(o).trim();return r.startsWith('"')?r.substring(1,r.length-1):r.startsWith("C:\\")?r.substring(3):`${c(this,_e)}/${r}`},St=function(n,t,o,r,l){t===Gt?n.frequency=44050:t!==qt&&(n.frequency=t),n.handle.rate(n.frequency/44050),o===K?n.volume=50:o!==Z&&(n.volume=o),D(this,U,xe).call(this,n),n.pan===-2?n.pan=0:r!==-1&&(n.pan=r),n.handle.stereo(n.pan/100),l===K?n.looping=0:l!==Z&&(n.looping=l),n.handle.loop(n.looping!==0),n.handle.play()},At=function(n,t,o,r,l){t===Gt?n.frequency=44050:t!==qt&&(n.frequency=t),n.handle.rate(n.frequency/44050),o===K?n.volume=50:o!==Z&&(n.volume=o);const u=(270-c(this,se).angle+360*(c(this,se).angle>270?1:0))*Math.PI/180,f=r-c(this,se).x,p=l-c(this,se).y,h=(f*Math.cos(u)-p*Math.sin(u))/c(this,Ae),y=(f*Math.sin(u)-p*Math.cos(u))/c(this,Ae),e=h*h;let i=e+y*y;i<1&&(i=1);const s=n.volume/i;D(this,U,xe).call(this,n,s);const d=Math.abs(e)<1?0:100*Math.sign(h)-100/(e*Math.sign(h));n.handle.stereo(d/100),n.handle.play()},xe=function(n,t){const o=t===void 0?n.volume:t;n.handle.volume(o/100*(c(this,me)/100)*(c(this,ie).sound/100))},tt=function(n){n.type==="mp3"?n.handle.volume(n.volume/100*(c(this,me)/100)*(c(this,ie).sound/100)):n.handle.then(t=>t.setVol(n.volume/100*(c(this,me)/100)*(c(this,ie).music/100)))},ln=function(n){const t=new DataView(n.buffer);switch(t.getUint16(0,!0)){case E.Initialize:{const o=t.getUint32(2,!0),r=t.getUint32(6,!0);console.log("Initialize",{quality:o,flags:r});break}case E.Close:console.log("Close");break;case E.Reset:console.log("Reset");break;case E.LoadSnd:{const o=t.getUint16(2,!0),r=D(this,U,wt).call(this,n.subarray(4,68)),l=t.getUint32(68,!0);o in c(this,G)&&(c(this,G)[o].handle.stop(),c(this,G)[o].handle.unload());try{const u=c(this,J).read(r),f=new Blob([u],{type:"audio/wav"});URL.createObjectURL(f),c(this,G)[o]={handle:new Ee.Howl({src:[URL.createObjectURL(f)],format:["wav"]}),frequency:44050,volume:100,pan:0,looping:0}}catch{console.error(`LoadSnd: Unable to read file '${r}'`)}console.log("LoadSnd",{slot:o,fileName:r,flags:l});break}case E.PlaySnd:{const o=t.getUint16(2,!0),r=t.getUint32(4,!0),l=t.getUint16(8,!0),u=t.getInt16(10,!0),f=t.getUint16(12,!0);let p=c(this,G)[o];if(!p){console.error("PlaySnd: soundHandle not found",{slot:o,freq:r,volume:l,pan:u,looping:f});break}D(this,U,St).call(this,p,r,l,u,f),console.log("PlaySnd",{slot:o,freq:p.frequency,volume:p.volume,pan:p.pan,looping:p.looping});break}case E.SetSndAttr:{const o=t.getUint16(2,!0),r=t.getUint32(4,!0),l=t.getUint16(8,!0),u=t.getInt16(10,!0),f=t.getUint16(12,!0),p=t.getUint32(14,!0);let h=c(this,G)[o];if(!h){console.error("PlaySnd: soundHandle not found",{slot:o,freq:r,volume:l,pan:u,looping:f});break}if(r!=Z){const y=r===K?44050:r;y!==h.frequency&&(h.frequency=y,h.handle.rate(y/44050))}if(l!=Z){const y=l===K?50:l;y!==h.volume&&(h.volume=y,D(this,U,xe).call(this,h))}if(u!=Z){const y=u===-2?0:u;y!==h.pan&&(h.pan=y,h.handle.stereo(h.pan/100))}if(f!=Z){const y=f===K?0:f;y!==h.looping&&(h.looping=y,h.handle.loop(f!==0))}console.log("SetSndAttr",{slot:o,freq:r,volume:l,pan:u,looping:f,flags:p});break}case E.GetSndAttr:console.log("GetSndAttr");break;case E.LoadMusic:{const o=t.getUint16(2,!0),r=D(this,U,wt).call(this,n.subarray(4,68)),l=t.getUint32(68,!0),u=t.getUint16(72,!0);if(o in c(this,R)){const p=c(this,R)[o];p.type==="mp3"?p.handle.stop():p.handle.then(h=>h.stop())}const f=l===K||!!(4&l);try{const p=c(this,J).read(r);if(u===1){const h=new Blob([p],{type:"audio/mp3"}),y=URL.createObjectURL(h);c(this,R)[o]={type:"mp3",handle:new Ee.Howl({src:y,format:["mp3"],loop:f}),volume:50,byteLength:p.byteLength}}else{const h=new Dt({repeatCount:f?-1:0}),y=new Promise(e=>{h.onInitialized(()=>{e(h)})});c(this,R)[o]={type:"mod",content:p,handle:y,volume:50}}}catch{console.error(`LoadMusic: Unable to read file '${r}'`)}console.log("LoadMusic",{slot:o,fileName:r,flags:l,musicType:u});break}case E.PlayMusic:{const o=t.getUint16(2,!0),r=c(this,R)[o];if(!r){console.error("PlayMusic: Music slot not found",{slot:o});break}r.type==="mp3"?r.handle.play():r.handle.then(l=>l.play(r.content.buffer)),console.log("PlayMusic",{slot:o});break}case E.SetMusicAttr:{const o=t.getUint16(2,!0),r=t.getInt16(4,!0),l=t.getUint16(6,!0),u=c(this,R)[o];if(!u){console.error("SetMusicAttr: Music slot not found",{slot:o});break}if(r!==-1){const f=r===-2?0:r;u.type==="mp3"&&u.handle.stereo(f/100)}if(l!==Z){const f=l===K?50:l;u.volume=f,D(this,U,tt).call(this,u)}console.log("SetMusicAttr",{slot:o,pan:r,volume:l});break}case E.GetMusicAttr:console.log("GetMusicAttr");break;case E.StopSnd:{const o=t.getUint16(2,!0),r=c(this,G)[o];if(!r){console.error("StopSnd: Music slot not found",{slot:o});break}r.handle.stop(),console.log("StopSnd",{slot:o});break}case E.PauseMusic:{const o=t.getUint16(2,!0),r=c(this,R)[o];if(!r){console.error("SetMusicAttr: Music slot not found",{slot:o});break}r.type==="mp3"?r.handle.pause():r.handle.then(l=>l.pause()),console.log("PauseMusic",{slot:o});break}case E.ResumeMusic:{const o=t.getUint16(2,!0),r=c(this,R)[o];if(!r){console.error("ResumeMusic: Music slot not found",{slot:o});break}r.type==="mp3"?r.handle.play():r.handle.then(l=>l.unpause()),console.log("ResumeMusic",{slot:o});break}case E.StopMusic:{const o=t.getUint16(2,!0),r=c(this,R)[o];if(!r){console.error("ResumeMusic: Music slot not found",{slot:o});break}r.type==="mp3"?r.handle.stop():r.handle.then(l=>l.stop()),console.log("StopMusic",{slot:o});break}case E.DeleteSnd:{const o=t.getUint16(2,!0);console.log("DeleteSnd",{slot:o});break}case E.DeleteMusic:{const o=t.getUint16(2,!0),r=c(this,R)[o];if(!r){console.error("ResumeMusic: Music slot not found",{slot:o});break}r.type==="mp3"?r.handle.unload():r.handle.then(l=>l.stop()),delete c(this,R)[o],console.log("DeleteMusic",{slot:o});break}case E.SetVolume:{const o=t.getUint16(2,!0);if(o!==Z){v(this,me,o===K?50:o);for(const l of Object.values(c(this,G)))D(this,U,xe).call(this,l);for(const l of Object.values(c(this,R)))D(this,U,tt).call(this,l)}console.log("SetVolume",{volume:o});break}case E.SetGlobalVols:{const o=t.getUint16(2,!0),r=t.getUint16(4,!0);if(o!==Z){const l=o===K?50:o;c(this,ie).sound=l;for(const u of Object.values(c(this,G)))D(this,U,xe).call(this,u)}if(r!==Z){const l=r===K?50:r;c(this,ie).music=l;for(const u of Object.values(c(this,R)))D(this,U,tt).call(this,u)}console.log("SetGlobalVolumes",{soundVolume:o,musicVolume:r});break}case E.Play2DSounds:{const o=t.getUint16(2,!0),r=t.getUint16(4,!0),l=t.getUint16(6,!0),u=t.getUint16(8,!0),f=[];for(let p=0;p<u;++p){const h=t.getUint16(10+16*p,!0),y=t.getUint16(2,!0),e=t.getUint32(4,!0),i=t.getUint16(8,!0),s=t.getInt16(10,!0),d=t.getInt16(12,!0),m=t.getInt16(14,!0);f.push({id:h,slot:y,freq:e,volume:i,x:s,y:d,angle:m});const g=c(this,G)[y];g?D(this,U,At).call(this,g,e,i,s,d):console.error("Play2DSounds: Music slot not found",{slot:y})}console.log("Play2DSounds",{posX:o,posY:r,angle:l,sndCount:u,soundQueue:f});break}case E.Play3DSounds:console.error("Play3DSounds: Not implemented");break;case E.GetMusicLength:{const o=t.getUint16(2,!0),r=c(this,R)[o];if(!r){console.error("GetMusicLength: Music slot not found",{slot:o});break}const l=new Uint8Array(4),u=new DataView(l.buffer);return r.type==="mp3"?(u.setUint32(0,r.byteLength,!0),console.log("GetMusicLength",{slot:o},l),Promise.resolve(l)):r.handle.then(f=>(u.setUint16(0,f.meta.totalOrders,!0),u.setUint16(2,0,!0),console.log("GetMusicLength",{slot:o},l),l))}case E.SetMusicPos:{const o=t.getUint16(2,!0),r=c(this,R)[o];if(!r){console.error("SetMusicPos: Music slot not found",{slot:o});break}if(r.type==="mp3"){if(r.byteLength===0){console.error("SetMusicPos: Sample byte length is zero");break}const l=t.getUint32(4,!0);if(l>r.byteLength){console.error("SetMusicPos: Position is after end");break}const u=1*l/r.byteLength*r.handle.duration();r.handle.seek(u),console.log("SetMusicPos",{slot:o,position:l})}else{const l=t.getUint16(4,!0),u=t.getUint16(6,!0);r.handle.then(f=>f.setOrderRow(l,u)),console.log("SetMusicPos",{slot:o,order:l,row:u})}break}case E.GetMusicPos:{const o=t.getUint16(2,!0),r=new Uint8Array(4),l=new DataView(r.buffer),u=c(this,R)[o];if(!u){console.error("GetMusicPos: Music slot not found",{slot:o});break}if(u.type==="mp3"){if(u.byteLength===0||u.handle.duration()===0){console.error("SetMusicPos: Sample byte length is zero");break}const f=1*u.handle.seek()/u.handle.duration()*u.byteLength|0;return l.setUint32(0,f),console.log("GetMusicPos",{slot:o},r),Promise.resolve(r)}return u.handle.then(f=>(l.setUint16(0,f.order,!0),l.setUint16(1,f.row,!0),console.log("GetMusicPos",{slot:o},r),r))}case E.Set3DPos:console.log("Set3DPos");break;case E.PlaySnd3D:console.log("PlaySnd3D");break;case E.Set3DFacts:console.log("Set3DFacts");break;case E.SetEAX:console.log("SetEAX");break;case E.PlaySounds:{const o=t.getUint16(2,!0),r=[];for(let l=0;l<o;++l){const u=4+16*l,f=t.getUint16(u,!0),p=t.getUint16(u+2,!0),h=t.getUint32(u+4,!0),y=t.getUint16(u+8,!0),e=t.getInt16(u+10,!0),i=t.getUint16(u+12,!0),s=c(this,G)[p];s?(D(this,U,St).call(this,s,h,y,e,i),r.push({id:f,slot:p,freq:h,volume:y,pan:e,looping:i})):console.error("PlaySounds: Music slot not found",{slot:p})}console.log("PlaySounds",{sndCount:o,soundQueue:r});break}case E.PlaySnd2D:{const o=t.getUint16(2,!0),r=t.getUint32(4,!0),l=t.getUint16(8,!0),u=t.getInt16(10,!0),f=t.getInt16(12,!0),p=t.getInt16(14,!0);let h=c(this,G)[o];if(!h){console.error("PlaySnd: soundHandle not found",{slot:o,freq:r,volume:l,x:u,y:f,angle:p});break}D(this,U,At).call(this,h,r,l,u,f),console.log("PlaySnd2D",{slot:o,freq:r,volume:l,x:u,y:f,angle:p});break}case E.Set2DPos:{const o=t.getInt16(2,!0),r=t.getInt16(4,!0),l=t.getInt16(6,!0);v(this,se,{x:o,y:r,angle:l}),console.log("Set2DPos",{posX:o,posY:r,angle:l});break}case E.Set2DDistFactor:{const o=t.getFloat32(2,!0);v(this,Ae,o),console.log("Set2DDistFactor",{distF:o});break}case E.CDInit:console.error("CDInit: Not implemented");break;case E.CDFree:console.error("CDFree: Not implemented");break;case E.GetTracks:{console.error("GetTracks: Not implemented");const o=new Uint8Array(2);return Promise.resolve(o)}case E.GetTrackLength:{console.error("GetTrackLength: Not implemented");const o=new Uint8Array(4);return Promise.resolve(o)}case E.CDPlay:{const o=t.getUint16(2,!0),r=t.getUint16(2,!0);console.error("CDPlay: Not implemented",{track:o,looping:r});break}default:console.error("Unrecognized command",{commandBytes:n})}return Promise.resolve(null)};(function(a){a[a.PlayMusic=1]="PlayMusic",a[a.ClearMusic=2]="ClearMusic",a[a.LoadSFX=3]="LoadSFX",a[a.SetVolume=4]="SetVolume",a[a.SetEAX=5]="SetEAX",a[a.StopSFX=6]="StopSFX",a[a.Set3D=7]="Set3D",a[a.SetChannel=8]="SetChannel",a[a.Pan=9]="Pan",a[a.Fade=10]="Fade",a[a.FeedBackMOD=11]="FeedBackMOD",a[a.FeedBackMP3=12]="FeedBackMP3",a[a.SetPosition=13]="SetPosition",a[a.Pause=14]="Pause",a[a.Resume=15]="Resume",a[a.Exit=55]="Exit",a[a.PlaySFX=56]="PlaySFX"})(N||(N={}));var te,Fe,Re,Ce,le,H,I,Tt,W,Et,cn;class Kn{constructor(n,t="",o=""){w(this,I);w(this,te);w(this,Fe);w(this,Re);w(this,Ce);w(this,le);w(this,H);v(this,te,n),v(this,Fe,t),v(this,Re,o),v(this,Ce,void 0),v(this,le,[]),v(this,H,{})}start(){v(this,Ce,setInterval(()=>{const n=c(this,te).poll();n!==0&&(D(this,I,cn).call(this,n),c(this,te).clear())},50))}stop(){clearInterval(c(this,Ce))}}te=new WeakMap,Fe=new WeakMap,Re=new WeakMap,Ce=new WeakMap,le=new WeakMap,H=new WeakMap,I=new WeakSet,Tt=function(){return c(this,te).read(`${c(this,Fe)}/DS4QB2.DAT`)},W=function(){const n=D(this,I,Tt).call(this);return new TextDecoder().decode(n).trim().split(/\s+/)},Et=function(n){const t=new Uint8Array(4*n.length),o=new DataView(t.buffer);for(let r=0;r<n.length;++r)o.setUint32(4*r,n[r]);c(this,te).write(`${c(this,Fe)}/DS4QB2.DAT`,t)},cn=function(n){var t,o;switch(n){case N.PlayMusic:{const[r,l,u,f,p]=D(this,I,W).call(this);console.log("PlayMusic",{musicFile:r,musicType:l,musicChannel:u,mRepeat:f,m3d:p}),c(this,H)[u]&&c(this,H)[u].handle.stop();const h=c(this,te).read(`${c(this,Re)}/${r}`);if(r.toUpperCase().endsWith("MP3")){const y=new Blob([h],{type:"audio/mp3"}),e=URL.createObjectURL(y);c(this,H)[u]={type:"mp3",handle:new Ee.Howl({src:e,format:["mp3"],loop:!!Number(f)})},c(this,H)[u].handle.play()}else c(this,H)[u]={type:"mod",handle:new Dt({repeatCount:f?-1:0})},c(this,H)[u].handle.onInitialized(()=>{c(this,H)[u].handle.play(h.buffer)});break}case N.ClearMusic:{const[r]=D(this,I,W).call(this);console.log("ClearMusic",{musicChannel:r}),r in c(this,H)&&c(this,H)[r].handle.stop();break}case N.LoadSFX:{const r=D(this,I,W).call(this);console.log("LoadSFX",r);for(const l of r){let u;u=l.startsWith('"')?l.substring(1,l.length-1):l.startsWith("C:\\")?l.substring(3):`${c(this,Re)}/${l}`;try{const f=c(this,te).read(u),p=new Blob([f],{type:"audio/wav"});URL.createObjectURL(p),c(this,le).push(new Ee.Howl({src:[URL.createObjectURL(p)],format:["wav"]}))}catch{console.error(`LoadSFX: Unable to read '${u}'`)}}break}case N.SetVolume:{const[r,l,u]=D(this,I,W).call(this);console.log("SetVolume",{musicVol:r,sampleVol:l,streamVol:u});for(const f of c(this,le))f.volume(Number(l)/100);for(const f of Object.values(c(this,H)))f.type==="mp3"?f.handle.volume(Number(u)/100):f.type==="mod"&&f.handle.setVol(Number(r)/100);break}case N.SetEAX:{const[r]=D(this,I,W).call(this);console.log("SetEAX",{eaxCode:r});break}case N.StopSFX:{const[r]=D(this,I,W).call(this);console.log("StopSFX",{sfxChannel:r}),c(this,le)[Number(r)].stop();break}case N.Set3D:{const[r,l,u,f,p,h,y]=D(this,I,W).call(this);console.log("Set3D",{musicChannel:r,posX:l,posY:u,posZ:f,velX:p,velY:h,velZ:y});break}case N.SetChannel:{const[r,l,u,f]=D(this,I,W).call(this);console.log("SetChannel",{musicChannel:r,freq:l,volume:u,pan:f});break}case N.Pan:{const[r,l,u,f]=D(this,I,W).call(this);console.log("Pan",{musicChannel:r,panPos:l,panEnd:u,panSpeed:f});break}case N.Fade:{const[r,l,u,f]=D(this,I,W).call(this);console.log("Fade",{musicChannel:r,fadePos:l,fadeEnd:u,fadeSpeed:f});const p=c(this,H)[r];if(p.type==="mp3"){const h=Number(l),y=Number(u),e=Math.abs((y-h)/Number(f));p.handle.fade(h,y,e)}break}case N.SetPosition:{const r=D(this,I,Tt).call(this),l=new DataView(r.buffer),u=l.getUint32(0,!0),f=l.getUint32(4,!0),p=l.getUint32(8,!0);console.log("SetPosition",{musicChannel:u,cSetPos1:f,cSetPos2:p});break}case N.FeedBackMOD:{const[r]=D(this,I,W).call(this);console.log("FeedbackMOD",{musicChannel:r}),D(this,I,Et).call(this,[0,0]);break}case N.FeedBackMP3:{const[r]=D(this,I,W).call(this);console.log("FeedbackMP3",{musicChannel:r}),D(this,I,Et).call(this,[0,0]);break}case N.Exit:console.log("Exit",{});for(const r of c(this,le))r.stop(),r.unload();for(const r of Object.values(c(this,H)))r.handle.stop();break;default:if(n>=N.PlaySFX){const r=n-N.PlaySFX;console.log("PlaySFX",{sfxHandle:r}),(o=(t=c(this,le))==null?void 0:t[r])==null||o.play()}}};var ne,$,Be,ce,ue,Q,it,un;class Jn{constructor(n,t){w(this,it);w(this,ne);w(this,$);w(this,Be);w(this,ce);w(this,ue);w(this,Q);v(this,ne,n),v(this,$,t),v(this,Be,null),v(this,ce,null),v(this,ue,[]),v(this,Q,null)}start(){v(this,Be,setInterval(()=>{const n=c(this,ne).poll();if(!n)return;const t=new TextDecoder().decode(n),o=t.indexOf("\0"),r=o!==-1?t.substring(0,o):t;r.startsWith("DS4QB")&&(D(this,it,un).call(this,r.substring(5)),c(this,ne).clear())},50))}stop(){clearInterval(c(this,Be))}}ne=new WeakMap,$=new WeakMap,Be=new WeakMap,ce=new WeakMap,ue=new WeakMap,Q=new WeakMap,it=new WeakSet,un=function(n){if(n.startsWith("LOADMOD")){const[t,o]=n.substring(7).split("|"),r=c(this,ne).read(t);r?(v(this,ce,new Dt({repeatCount:o==="1"?-1:0})),c(this,ce).onInitialized(()=>c(this,ce).play(r.buffer)),c(this,$).log("LoadMod",{path:t,repeat:o})):c(this,$).error("LoadMod: unable to load file",{path:t,repeat:o})}else if(n.startsWith("LOADSAMPLES")){const t=n.substring(11).split("|")[0],o=c(this,ne).read(t);if(!o)return void c(this,$).error("LoadSamples: unable to load sample list",{path:t});const r=new TextDecoder().decode(o).split(`\r
`).filter(l=>l.length>0);for(const l of r){const u=c(this,ne).read(l);if(u===null)c(this,$).error("LoadSamples: file not found",{path:l}),c(this,ue).push(null);else{const f=new Blob([u],{type:"audio/wav"});c(this,ue).push(new Ee.Howl({src:[URL.createObjectURL(f)],format:["wav"]}))}}c(this,$).log("LoadSamples",{path:t,sampleFiles:r})}else if(n.startsWith("LOADSTREAM")){const[t,o]=n.substring(10).split("|"),r=c(this,ne).read(t);if(r===null)c(this,$).error("LoadStream: Error loading file",{path:t,repeat:o});else{const l=new Blob([r],{type:"audio/mp3"});v(this,Q,new Ee.Howl({src:[URL.createObjectURL(l)],format:["mp3"]})),c(this,Q).loop(o==="1"),c(this,Q).on("load",()=>{var u;return(u=c(this,Q))==null?void 0:u.play()})}c(this,$).log("LoadStream",{path:t,repeat:o})}else if(n.startsWith("PLAYCD")){const t=Number(n.substring(6).split("|")[0]);console.error("PlayCD: Not implemented",{track:t})}else if(n.startsWith("PLAYSAMPLE")){const t=Number(n.substring(10).split("|")[0]);try{c(this,ue)[t-1].play(),c(this,$).log("PlaySample",{sampleId:t})}catch{c(this,$).error("PlaySample: unable to play",{sampleId:t})}}else if(n.startsWith("REMOVEMODULE|")){if(c(this,ce)===null)return;c(this,ce).stop(),c(this,$).log("RemoveModule")}else if(n.startsWith("REMOVESAMPLES|")){for(const t of c(this,ue))t==null||t.stop(),t==null||t.unload();v(this,ue,[]),c(this,$).log("RemoveSamples")}else n.startsWith("REMOVESTREAM|")&&(c(this,Q)?(c(this,Q).stop(),c(this,Q).unload(),v(this,Q,null),c(this,$).log("RemoveStream")):c(this,$).error("RemoveStream: no active stream"))};var de,Y,Ne,$e,j,ge,z,st,dn;class er{constructor(n,t){w(this,st);w(this,de);w(this,Y);w(this,Ne);w(this,$e);w(this,j);w(this,ge);w(this,z);v(this,de,n),v(this,Y,t),v(this,Ne,0),v(this,$e,0),v(this,j,!1),v(this,ge,0),v(this,z,null),n.bus.register("emulator-started",()=>{n.v86.cpu.io.register_write(19027,this,()=>{},o=>{v(this,Ne,o)},()=>{}),n.v86.cpu.io.register_write(19028,this,()=>{},o=>{v(this,$e,o)},()=>{}),n.v86.cpu.io.register_read(19027,this,()=>{},()=>D(this,st,dn).call(this),()=>{})})}read(){return c(this,z)===null?null:{format:c(this,ge),bytes:c(this,z)}}empty(){v(this,z,null),v(this,ge,0)}}de=new WeakMap,Y=new WeakMap,Ne=new WeakMap,$e=new WeakMap,j=new WeakMap,ge=new WeakMap,z=new WeakMap,st=new WeakSet,dn=function(){const n=16*c(this,Ne)+c(this,$e),t=c(this,de).read_memory(n,12),o=new DataView(t.buffer,t.byteOffset,t.byteLength),r=o.getUint16(0,!0),l=o.getUint16(2,!0),u=o.getUint16(4,!0),f=o.getUint16(6,!0),p=o.getUint16(8,!0),h=o.getUint16(10,!0);switch(r){case 5888:return c(this,Y).debug("Clipboard: Is Clipboard Available?"),19027;case 5889:return c(this,Y).debug("Clipboard: Open Clipboard"),c(this,j)?0:(v(this,j,!0),1);case 5890:return c(this,Y).debug("Clipboard: Empty Clipboard"),c(this,j)?(v(this,z,null),v(this,ge,0),1):0;case 5891:{if(c(this,Y).debug("Clipboard: Set Clipboard Data",{ax:r,bx:l,cx:u,dx:f,es:p,si:h}),!c(this,j))return 0;const y=16*p+l,e=65536*h+u+1;return v(this,ge,f),v(this,z,c(this,de).read_memory(y,e).slice()),console.debug("Data:",c(this,z)),1}case 5892:return c(this,Y).debug("Clipboard: Get Clipboard Data Size"),c(this,j)&&c(this,z)?(o.setUint16(0,c(this,z).byteLength>>16,!0),c(this,de).write_memory(t,n),65535&c(this,z).byteLength):(o.setUint16(0,0,!0),0);case 5893:{if(c(this,Y).debug("Clipboard: Get Clipboard Data",{bx:l,es:p}),!c(this,j)||!c(this,z))return 0;const y=16*p+l;return c(this,de).write_memory(c(this,z),y),1}case 5896:return c(this,Y).debug("Clipboard: Close Clipboard"),c(this,j)?(v(this,j,!1),1):0;case 5897:{c(this,Y).debug("Clipboard: Will My Data Fit?",{cx:u,si:h});const y=65536*h+u+1;return o.setUint16(0,y>>16,!0),c(this,de).write_memory(t,n),65535&y}default:c(this,Y).error("Clipboard: Error: unrecognized function",{ax:r,bx:l,cx:u,dx:f,es:p,si:h})}};function Ht(a,n,t){return{read:o=>n.session(()=>n.readFile(t.toFatPath(o))),write:(o,r)=>n.session(()=>n.writeFile(t.toFatPath(o),r)),poll:()=>a.v86.cpu.io.port_read8(0),clear:()=>{a.v86.cpu.io.port_write8(0,0),a.v86.cpu.io.port_write8(0,0)}}}async function tr(a,n){const t=[];n.addMouse&&t.push("A:\\MOUSE"),n.addEms&&t.push("A:\\EMSMAGIC"),n.protocol==="ds4qb"&&t.push("A:\\CLIPEMU"),n.autoExe&&t.push(n.autoExe);const o=await async function(p,h){const y=await sn(p),e=await Ye.create(y);return e.session(()=>{if(h&&h.length>0){const i=e.readFile("AUTOEXEC.BAT"),s=[new TextDecoder().decode(i),"C:",...h].join(`\r
`),d=new TextEncoder().encode(s);e.writeFile("AUTOEXEC.BAT",d)}}),y}(n.fdaImageFile,t),{image:r,disk:l,pathMap:u}=await jn(n.content);n.protocol==="ds4qb++"&&l.session(()=>{const p=new Uint8Array(10),h=new DataView(p.buffer);h.setUint16(0,1,!0),h.setUint16(2,1,!0),h.setUint16(4,1,!0),h.setUint32(6,44050,!0),l.writeFile(n.configPath??"SOUNDSYS.CFG",p)});var f=new a({screen_container:n.screenContainer,bios:n.biosFile,vga_bios:n.vgaBiosFile,fda:{buffer:o.buffer},hda:{buffer:r.buffer},boot_order:801,autostart:!0,wasm_path:n.v86WasmUrl});return f.add_listener("emulator-ready",async function(){let p;switch(n.protocol){case"ds4qb":const h=function(y,e,i){const s=new er(y,console);return{read:d=>e.session(()=>e.readFile(i.toFatPath(d))),poll:()=>{var d;return((d=s.read())==null?void 0:d.bytes)??null},clear:()=>{s.empty()}}}(f,l,u);p=new Jn(h,console);break;case"ds4qb2":{const y=Ht(f,l,u);p=new Kn(y,(n==null?void 0:n.ds4qbDatPath)??"",(n==null?void 0:n.workingDir)??"");break}case"ds4qb++":{const y=Ht(f,l,u);p=new Zn(y,n==null?void 0:n.workingDir);break}case"none":console.log("No protocol");break;default:p={start:()=>{},stop:()=>{}},console.error("Unrecognized protocol: ")}setTimeout(()=>{console.debug("Starting DS4QB service"),p.start()},250)}),r}const fn=document.getElementById("screen_container");if(!fn)throw"screen_container not found";const k=new URL("..",import.meta.url),lt={acalypha:{name:"Acalypha 0.8b",author:"VGameSoft",status:"Ok",content:{url:`${k}/apps/aca08b.zip`},workingDir:"",autoExe:"ACA",protocol:"ds4qb2",addEms:!0},alunia:{name:"Tales Of Alunia Demo V0.1",author:"Fenris Productions",status:"Hangs",content:{url:`${k}/apps/alunia.zip`},workingDir:"",autoExe:"",protocol:"ds4qb",addEms:!0},boarding:{name:"Boarding: The Ultimate Snowboarding Adventure",author:"Chaos Media",status:"Ok",content:{url:`${k}/apps/boarding.zip`},autoExe:"NOSFX",protocol:"ds4qb",addEms:!0},blubberd1:{name:"Blubber Dragon 2.04 part 1",author:"Draco RedScale",status:"Ok",content:{url:`${k}/apps/BlubberD1.zip`},workingDir:"SOUNDSYS",autoExe:"BLUBBERD",protocol:"ds4qb++",addEms:!0,addMouse:!0},cai3:{name:"Cai's Quest 3: The Runic War",author:"Venosoft",status:"Ok",content:{url:`${k}/apps/cai3.zip`},ds4qbDatPath:"",workingDir:"",autoExe:"Cai3",protocol:"ds4qb2",addEms:!1,addMouse:!1},ctf:{name:"Capture the Flag",author:"Nebula Software",status:"Ok",content:{url:`${k}/apps/ctf.zip`},ds4qbDatPath:"Audio",workingDir:"Audio",autoExe:"Run",protocol:"ds4qb2",addEms:!1,addMouse:!0},ds4qb:{name:"DS4QB Demo",author:"Lost Sock Software",status:"Ok",content:{url:`${k}/apps/ds4qb.zip`},autoExe:"DEMOCODE",protocol:"ds4qb"},ds4qb2:{name:"DS4QB2 Demo",author:"AetherSoft",status:"Ok",content:{url:`${k}/apps/ds4qb2.zip`},autoExe:"DSDEMO",protocol:"ds4qb2"},ds4qbpp:{name:"DS4QB2 Demo",author:"AetherSoft",status:"Ok",content:{url:`${k}/apps/ds4qbpp-demo.zip`},autoExe:"TEST",protocol:"ds4qb++",workingDir:"SOUNDSYS"},fj:{name:"Frantic Journey",author:"Adigun A. Polack",status:"Missing Sound",content:{url:`${k}/apps/fj552003.zip`},workingDir:"",autoExe:"FJDEMO",protocol:"ds4qb2",addEms:!0},ghini:{name:"Ghini Run",author:"Piptol",status:"Ok",content:{url:`${k}/apps/ghinirun.zip`},workingDir:"SOUNDSYS",autoExe:"GHINI",protocol:"ds4qb++",addEms:!0},hero:{name:"Hero",author:"BAS",status:"Ok",content:{url:`${k}/apps/hero-pack-20.zip`},workingDir:"",ds4qbDatPath:"SOUND",autoExe:"HERO",protocol:"ds4qb2",addEms:!0},keen7:{name:"Commander Keen 7 build 13",author:"Kevin Wellwood",status:"Slow",content:{url:`${k}/apps/keen7-b13.zip`},workingDir:"",autoExe:"KEEN7",protocol:"ds4qb++",addEms:!0},larry:{name:"Larry the Dinosaur 2",author:"Delta Code",status:"Ok",content:{url:`${k}/apps/larrydino2.zip`},workingDir:"SOUNDSYS",autoExe:"LD2",protocol:"ds4qb++",addEms:!1},lovebyte:{name:"Love Byte",author:"Binit Sherstha",status:"Ok",content:{url:`${k}/apps/lovebyte.zip`},workingDir:"",ds4qbDatPath:"",autoExe:"LOVE",protocol:"ds4qb2",addEms:!0,addMouse:!0},mattress:{name:"Mattress Warrior",author:"DarkDread",status:"Ok",content:{url:`${k}/apps/mattress.zip`},workingDir:"SOUNDSYS",autoExe:"MWMUSIC",protocol:"ds4qb++",addEms:!1},metalqb:{name:"Metal QB",author:"The Stars Development Company",status:"Ok",content:{url:`${k}/apps/metalqb.zip`},workingDir:"SOUNDSYS",autoExe:"METALQB",protocol:"ds4qb++",addEms:!0},nedemo2:{name:"Nebula Engine II Demo",author:"Nebula Software",status:"Ok",content:{url:`${k}/apps/ne_demo2.zip`},workingDir:"PROGRAM\\SOUNDSYS",autoExe:"DEMO",protocol:"ds4qb++",configPath:"PROGRAM\\SOUNDSYS.CFG",addEms:!0},pedxing:{name:"Ped Xing's Quest",author:"Typosoft",status:"Crashes",content:{url:`${k}/apps/pedxing.zip`},workingDir:"SOUNDSYS",autoExe:"PEDXING",protocol:"ds4qb++",addEms:!0},qtanks:{name:"QTanks",author:"Dennis Meuwissen",status:"Ok",content:{url:`${k}/apps/qtanks11.zip`},ds4qbDatPath:"",workingDir:"",autoExe:"QTANKS",protocol:"ds4qb2",addEms:!1,addMouse:!0},resistance:{name:"Resistance",author:"Nebula Software",status:"Hangs",content:{url:`${k}/apps/resistance.zip`},workingDir:"AUDIO",ds4qbDatPath:"AUDIO",autoExe:"RUN",protocol:"ds4qb2",addEms:!0},sasdemo:{name:"Star Angelic S Demo",author:"Adigun A. Polack",status:"Ok",content:{url:`${k}/apps/StarAngelicSDemo.zip`},workingDir:"",autoExe:"SASDEMO",protocol:"ds4qb2",addEms:!0},skatey:{name:"Skatey",author:"Qasir Games",status:"Hangs",content:{url:`${k}/apps/skatey.zip`},workingDir:"",autoExe:"SKATE",protocol:"ds4qb",addEms:!1},soc3:{name:"Secret of Cooey 3 Demo",author:"DarkDread",status:"Ok",content:{url:`${k}/apps/soc3demo.zip`},ds4qbDatPath:"",workingDir:"",autoExe:"SOC3",protocol:"ds4qb2",addEms:!1,addMouse:!1},squealer:{name:"Squealer TNT",author:"Piptol",status:"Ok",content:{url:`${k}/apps/SquealerTNT.zip`},ds4qbDatPath:"",workingDir:"",autoExe:"SQUEALER",protocol:"ds4qb2",addEms:!1,addMouse:!1},ssumo:{name:"Super Sumo Wrestling",author:"Typosoft",status:"Ok",content:{url:`${k}/apps/ssumo.zip`},workingDir:"",autoExe:"SUMO",protocol:"ds4qb2",ds4qbDatPath:"DATA",addEms:!0},ssumo2:{name:"Super Sumo Wrestling 2",author:"Typosoft",status:"Ok",content:{url:`${k}/apps/SuperSumo2.zip`},workingDir:"",autoExe:"SUMO",protocol:"ds4qb2",ds4qbDatPath:"DATA",addEms:!0},tankz:{name:"Tankz",author:"Vladi Abramzon",status:"Hangs",content:{url:`${k}/apps/tankz.zip`},autoExe:"TANKZ",protocol:"ds4qb2",ds4qbDatPath:""},terra:{name:"TerraScape: Breakdown Velocity",author:"PieSlice Productions",status:"Ok",content:{url:`${k}/apps/terrascape.ZIP`},ds4qbDatPath:"",workingDir:"",autoExe:"TERRA /SOUNDON",protocol:"ds4qb2",addEms:!1,addMouse:!0},zeta:{name:"Zeta B2",author:"AetherSoft",status:"Hangs",content:{url:`${k}/apps/ZetaB2.zip`},ds4qbDatPath:"Data",workingDir:"",autoExe:"ZETA",protocol:"ds4qb2",addEms:!1,addMouse:!0}},nr=new URLSearchParams(window.location.search),zt=nr.get("game")??"";if(zt)tr(window.V86,{screenContainer:fn,...lt[zt],biosFile:{url:`${k}/bios/seabios.bin`},vgaBiosFile:{url:`${k}/bios/VGABIOS-lgpl.bin`},fdaImageFile:{url:`${k}/img/Dos6.22.img`},v86WasmUrl:`${k}/v86/v86.wasm`}).then(a=>{var n;(n=document.getElementById("download"))==null||n.addEventListener("click",()=>{const t=new Blob([a],{type:"application/octet-stream"}),o=window.URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download="hda.img",document.body.appendChild(r),r.style.display="none",r.click(),r.remove(),setTimeout(()=>window.URL.revokeObjectURL(o),1e3)})});else{const a=document.getElementById("download");a&&(a.style.display="none")}function kt(a,n){return a[1].name<n[1].name?1:a[1].name>n[1].name?-1:0}const rr=Object.entries(lt).filter(([,a])=>a.protocol==="ds4qb").sort(kt),or=Object.entries(lt).filter(([,a])=>a.protocol==="ds4qb2").sort(kt),ar=Object.entries(lt).filter(([,a])=>a.protocol==="ds4qb++").sort(kt),_t=document.querySelector("tr#ds4qbgames");for(const[a,n]of rr)_t==null||_t.insertAdjacentHTML("afterend",`<tr><td><a href="?game=${a}">${n.name}</a></td><td>${n.author}</td><td>${n.status}</td></tr>`);const mt=document.querySelector("tr#ds4qb2games");for(const[a,n]of or)mt==null||mt.insertAdjacentHTML("afterend",`<tr><td><a href="?game=${a}">${n.name}</a></td><td>${n.author}</td><td>${n.status}</td></tr>`);const gt=document.querySelector("tr#ds4qbppgames");for(const[a,n]of ar)gt==null||gt.insertAdjacentHTML("afterend",`<tr><td><a href="?game=${a}">${n.name}</a></td><td>${n.author}</td><td>${n.status}</td></tr>`);
